(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1751],{31935:function(e,t,r){Promise.resolve().then(r.bind(r,4441))},4441:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return B}});var a=r(57437),s=r(2265),n=r(5978),i=r(99764),o=r(60062),l=r(71245),d=r(79820),c=r(33804),u=r(12381),m=r(69174),f=r(5485),p=r(53927),h=r(54233),x=r(14787),j=r(15291),v=r(75060),g=r(74291),b=r(68245),N=r(43643),y=r(93448);let w=s.forwardRef((e,t)=>{let{className:r,children:s,...n}=e;return(0,a.jsxs)(N.fC,{ref:t,className:(0,y.cn)("relative overflow-hidden",r),...n,children:[(0,a.jsx)(N.l_,{className:"h-full w-full rounded-[inherit]",children:s}),(0,a.jsx)(C,{}),(0,a.jsx)(N.Ns,{})]})});w.displayName=N.fC.displayName;let C=s.forwardRef((e,t)=>{let{className:r,orientation:s="vertical",...n}=e;return(0,a.jsx)(N.gb,{ref:t,orientation:s,className:(0,y.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...n,children:(0,a.jsx)(N.q4,{className:"relative flex-1 rounded-full bg-border"})})});function S(e){let{open:t,onClose:r,documentos:n,onImport:i}=e,[o,l]=(0,s.useState)([]);return(0,a.jsx)(g.Vq,{open:t,onOpenChange:r,children:(0,a.jsxs)(g.cZ,{className:"max-w-xl",children:[(0,a.jsx)(g.fK,{children:(0,a.jsx)(g.$N,{children:"Importar Documentos Corporativos"})}),(0,a.jsx)(w,{className:"max-h-80 mt-4 border rounded-md p-3",children:n.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-3 py-2 border-b",children:[(0,a.jsx)(b.X,{checked:o.includes(e.id),onCheckedChange:()=>{var t;return t=e.id,void l(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])}}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:[e.code," â€” ",e.name]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.category," \xb7 v",e.version]})]})]},e.id))}),(0,a.jsxs)(g.cN,{children:[(0,a.jsx)(u.z,{variant:"outline",onClick:r,children:"Cancelar"}),(0,a.jsxs)(u.z,{onClick:()=>i(o),disabled:0===o.length,children:["Importar (",o.length,")"]})]})]})})}C.displayName=N.gb.displayName;var I=r(40279),k=r(23340),_=r(53459);function D(e){let{open:t,onClose:r,projectId:l,companyId:d,userId:c}=e,{toast:m}=(0,k.pm)(),[f,p]=(0,s.useState)(""),[h,x]=(0,s.useState)(""),[b,N]=(0,s.useState)(""),[y,w]=(0,s.useState)("1"),[C,S]=(0,s.useState)(null),[D,E]=(0,s.useState)(!1),R=()=>{p(""),x(""),N(""),w("1"),S(null)},z=()=>{D||(R(),r())},V=async()=>{if(!C){m({variant:"destructive",title:"Error",description:"Debes seleccionar un archivo PDF."});return}if("application/pdf"!==C.type){m({variant:"destructive",title:"Error",description:"El archivo debe ser de tipo PDF."});return}if(!f||!h||!b||!y||!l||!d||!c){m({variant:"destructive",title:"Error",description:"Todos los campos son obligatorios."});return}E(!0);try{let e=(0,n.JU)((0,n.hJ)(i.N$,"projectDocuments")),t=e.id,r="projectDocuments/".concat(l,"/").concat(t,".pdf"),a=(0,o.iH)(i.IG,r);await (0,o.KV)(a,C);let s=await (0,o.Jt)(a),u={companyId:d,projectId:l,companyDocumentId:null,code:f,name:h,category:b,versionAsignada:y,vigente:!0,obsoleto:!1,eliminado:!1,fileUrl:s,storagePath:r,assignedAt:(0,n.Bt)(),assignedById:c};await (0,n.pl)(e,u),m({title:"\xc9xito",description:"Documento subido y registrado correctamente."}),z()}catch(e){console.error("Error subiendo documento:",e),m({variant:"destructive",title:"Error",description:"No se pudo subir el documento."})}finally{E(!1)}};return(0,a.jsx)(g.Vq,{open:t,onOpenChange:z,children:(0,a.jsxs)(g.cZ,{className:"max-w-lg",children:[(0,a.jsx)(g.fK,{children:(0,a.jsx)(g.$N,{children:"Subir Documento Espec\xedfico del Proyecto"})}),(0,a.jsxs)("div",{className:"space-y-4 mt-2",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v._,{htmlFor:"code",children:"C\xf3digo*"}),(0,a.jsx)(I.I,{id:"code",value:f,onChange:e=>p(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v._,{htmlFor:"version",children:"Versi\xf3n*"}),(0,a.jsx)(I.I,{id:"version",value:y,onChange:e=>w(e.target.value)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v._,{htmlFor:"name",children:"Nombre del Documento*"}),(0,a.jsx)(I.I,{id:"name",value:h,onChange:e=>x(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v._,{htmlFor:"category",children:"Categor\xeda*"}),(0,a.jsxs)(j.Ph,{onValueChange:N,value:b,children:[(0,a.jsx)(j.i4,{id:"category",children:(0,a.jsx)(j.ki,{placeholder:"Seleccionar..."})}),(0,a.jsxs)(j.Bw,{children:[(0,a.jsx)(j.Ql,{value:"Seguridad",children:"Seguridad"}),(0,a.jsx)(j.Ql,{value:"Calidad",children:"Calidad"}),(0,a.jsx)(j.Ql,{value:"Medio Ambiente",children:"Medio Ambiente"}),(0,a.jsx)(j.Ql,{value:"Operaciones",children:"Operaciones"}),(0,a.jsx)(j.Ql,{value:"Planos",children:"Planos"}),(0,a.jsx)(j.Ql,{value:"Otros",children:"Otros"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v._,{htmlFor:"file",children:"Archivo PDF*"}),(0,a.jsx)(I.I,{id:"file",type:"file",accept:"application/pdf",onChange:e=>{var t,r;return S(null!==(r=null===(t=e.target.files)||void 0===t?void 0:t[0])&&void 0!==r?r:null)}})]})]}),(0,a.jsxs)(g.cN,{children:[(0,a.jsx)(u.z,{variant:"outline",onClick:z,disabled:D,children:"Cancelar"}),(0,a.jsxs)(u.z,{onClick:V,disabled:D||!C||!h||!f||!b,children:[D&&(0,a.jsx)(_.Z,{className:"mr-2 h-4 w-4 animate-spin"}),D?"Subiendo...":"Subir Documento"]})]})]})})}var E=r(27648),R=r(28119),z=r(76848),V=r(59559),F=r(78084);let P=R.fC,Z=R.xz;R.ZA,R.Uv,R.Tr,R.Ee,s.forwardRef((e,t)=>{let{className:r,inset:s,children:n,...i}=e;return(0,a.jsxs)(R.fF,{ref:t,className:(0,y.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",r),...i,children:[n,(0,a.jsx)(z.Z,{className:"ml-auto"})]})}).displayName=R.fF.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(R.tu,{ref:t,className:(0,y.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...s})}).displayName=R.tu.displayName;let O=s.forwardRef((e,t)=>{let{className:r,sideOffset:s=4,...n}=e;return(0,a.jsx)(R.Uv,{children:(0,a.jsx)(R.VY,{ref:t,sideOffset:s,className:(0,y.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...n})})});O.displayName=R.VY.displayName;let A=s.forwardRef((e,t)=>{let{className:r,inset:s,...n}=e;return(0,a.jsx)(R.ck,{ref:t,className:(0,y.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",r),...n})});function $(e){let{open:t,onClose:r,projectDocument:l,userId:d}=e,{toast:c}=(0,k.pm)(),[m,f]=(0,s.useState)(""),[p,h]=(0,s.useState)(null),[x,j]=(0,s.useState)(!1),b=()=>{f(""),h(null)},N=()=>{x||(b(),r())},y=async()=>{if(!p||!m){c({variant:"destructive",title:"Error",description:"Debes proporcionar una nueva versi\xf3n y un archivo PDF."});return}if("application/pdf"!==p.type){c({variant:"destructive",title:"Error",description:"El archivo debe ser de tipo PDF."});return}j(!0);try{let e=(0,n.qs)(i.N$),t=(0,n.JU)(i.N$,"projectDocuments",l.id);e.update(t,{vigente:!1,obsoleto:!0});let r=(0,n.JU)((0,n.hJ)(i.N$,"projectDocuments")),a=r.id,s="projectDocuments/".concat(l.projectId,"/").concat(a,".pdf"),u=(0,o.iH)(i.IG,s);await (0,o.KV)(u,p);let f=await (0,o.Jt)(u);e.set(r,{companyId:l.companyId,projectId:l.projectId,companyDocumentId:l.companyDocumentId,code:l.code,name:l.name,category:l.category,versionAsignada:m,vigente:!0,obsoleto:!1,eliminado:!1,fileUrl:f,storagePath:s,assignedAt:(0,n.Bt)(),assignedById:d}),await e.commit(),c({title:"Versi\xf3n actualizada",description:"El documento ha sido actualizado a la nueva versi\xf3n."}),N()}catch(e){console.error("Error cambiando la versi\xf3n del documento:",e),c({variant:"destructive",title:"Error",description:"No se pudo actualizar la versi\xf3n del documento."})}finally{j(!1)}};return(0,a.jsx)(g.Vq,{open:t,onOpenChange:N,children:(0,a.jsxs)(g.cZ,{className:"max-w-lg",children:[(0,a.jsx)(g.fK,{children:(0,a.jsx)(g.$N,{children:"Cambiar Versi\xf3n del Documento"})}),(0,a.jsxs)("div",{className:"space-y-4 mt-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:[l.code," - ",l.name]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Versi\xf3n actual: ",l.versionAsignada]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v._,{htmlFor:"newVersion",children:"Nueva Versi\xf3n*"}),(0,a.jsx)(I.I,{id:"newVersion",value:m,onChange:e=>f(e.target.value),placeholder:"Ej: 2.0"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v._,{htmlFor:"file",children:"Nuevo Archivo PDF*"}),(0,a.jsx)(I.I,{id:"file",type:"file",accept:"application/pdf",onChange:e=>{var t,r;return h(null!==(r=null===(t=e.target.files)||void 0===t?void 0:t[0])&&void 0!==r?r:null)}})]})]}),(0,a.jsxs)(g.cN,{children:[(0,a.jsx)(u.z,{variant:"outline",onClick:N,disabled:x,children:"Cancelar"}),(0,a.jsxs)(u.z,{onClick:y,disabled:x||!p||!m,children:[x&&(0,a.jsx)(_.Z,{className:"mr-2 h-4 w-4 animate-spin"}),x?"Actualizando...":"Actualizar Versi\xf3n"]})]})]})})}function J(e){let{vigente:t,obsoleto:r}=e;return r?(0,a.jsx)(m.C,{variant:"destructive",children:"Obsoleto"}):t?(0,a.jsx)(m.C,{variant:"default",children:"Vigente"}):(0,a.jsx)(m.C,{variant:"secondary",children:"No Vigente"})}function B(){let{user:e,companyId:t,role:r}=(0,l.a)(),{toast:m}=(0,k.pm)(),[g,b]=(0,s.useState)([]),[N,y]=(0,s.useState)(""),[w,C]=(0,s.useState)([]),[_,R]=(0,s.useState)([]),[z,V]=(0,s.useState)(!0),[F,B]=(0,s.useState)(!1),[U,Q]=(0,s.useState)(!1),[T,q]=(0,s.useState)(!1),[L,M]=(0,s.useState)(null),[X,G]=(0,s.useState)(""),[H,K]=(0,s.useState)("all"),[Y,W]=(0,s.useState)("all"),ee=(0,s.useMemo)(()=>Array.from(new Set(w.map(e=>e.category))),[w]);(0,s.useEffect)(()=>{let e;if(!t&&"superadmin"!==r)return;e="superadmin"===r?(0,n.IO)((0,n.hJ)(i.N$,"obras"),(0,n.Xo)("nombreFaena")):(0,n.IO)((0,n.hJ)(i.N$,"obras"),(0,n.ar)("empresaId","==",t),(0,n.Xo)("nombreFaena"));let a=(0,n.cf)(e,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));b(t),t.length>0&&!N&&y(t[0].id)});return()=>a()},[t,r,N]),(0,s.useEffect)(()=>{if(!N){C([]);return}V(!0);let e=(0,n.IO)((0,n.hJ)(i.N$,"projectDocuments"),(0,n.ar)("projectId","==",N),(0,n.Xo)("code","asc")),t=(0,n.cf)(e,e=>{C(e.docs.map(e=>({id:e.id,...e.data()}))),V(!1)});return()=>t()},[N]);let et=(0,s.useMemo)(()=>w.filter(e=>{if(e.eliminado)return!1;let t=""===X||e.name.toLowerCase().includes(X.toLowerCase())||e.code.toLowerCase().includes(X.toLowerCase()),r="all"===H||e.category===H,a="all"===Y||"vigente"===Y&&e.vigente&&!e.obsoleto||"obsoleto"===Y&&e.obsoleto;return t&&r&&a}),[w,X,H,Y]);(0,s.useEffect)(()=>{var e;if(!t&&"superadmin"!==r)return;let a="superadmin"===r?null===(e=g[0])||void 0===e?void 0:e.empresaId:t;if(!a)return;let s=(0,n.IO)((0,n.hJ)(i.N$,"companyDocuments"),(0,n.ar)("companyId","==",a),(0,n.Xo)("code","asc")),o=(0,n.cf)(s,e=>{R(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{console.error("Error fetching corporate documents:",e),m({variant:"destructive",title:"Error",description:"No se pudieron cargar los documentos corporativos."})});return()=>o()},[t,r,g]);let er=async r=>{if(!N||!t||!e){m({variant:"destructive",title:"Error",description:"No se ha seleccionado una obra o falta informaci\xf3n de usuario."});return}let a=_.filter(e=>r.includes(e.id));if(0!==a.length)try{let r=(0,n.hJ)(i.N$,"projectDocuments"),l=(0,n.IO)(r,(0,n.ar)("projectId","==",N)),d=await (0,n.PL)(l),c=new Set(d.docs.map(e=>e.data().companyDocumentId)),u=(0,n.qs)(i.N$),f=0,p=0;for(let i of a){var s,o;if(c.has(i.id)){p++;continue}let a=(0,n.JU)(r),l={companyId:t,projectId:N,companyDocumentId:i.id,code:i.code,name:i.name,category:i.category,versionAsignada:i.version,vigente:!0,obsoleto:!1,eliminado:!1,fileUrl:null!==(s=i.fileUrl)&&void 0!==s?s:null,storagePath:null!==(o=i.storagePath)&&void 0!==o?o:null,assignedAt:(0,n.Bt)(),assignedById:e.uid};u.set(a,l),f++}await u.commit();let h="Se importaron ".concat(f," documentos nuevos.");p>0&&(h+=" Se omitieron ".concat(p," por ya existir en el proyecto.")),m({title:"Importaci\xf3n completada",description:h})}catch(e){console.error("Error al importar documentos:",e),m({variant:"destructive",title:"Error",description:"No se pudieron importar los documentos."})}finally{B(!1)}},ea=e=>{M(e),q(!0)},es=async e=>{if(!e.storagePath){m({variant:"destructive",title:"Error",description:"Este documento no tiene un archivo asociado."});return}try{let t=(0,o.iH)(i.IG,e.storagePath),r=await (0,o.Jt)(t);window.open(r,"_blank")}catch(e){console.error("Error al obtener la URL de descarga:",e),m({variant:"destructive",title:"Error de descarga",description:"No se pudo obtener el enlace del archivo. Verifique los permisos de CORS en su bucket de Firebase Storage."})}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(u.z,{asChild:!0,variant:"outline",size:"sm",children:(0,a.jsxs)(E.default,{href:"/dashboard",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Volver al Dashboard"]})}),(0,a.jsxs)("header",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Documentos del Proyecto"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Documentos aplicados a una obra espec\xedfica."})]}),"prevencionista"!==r&&(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(u.z,{variant:"outline",onClick:()=>B(!0),disabled:!N,children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4"})," Importar Corporativos"]}),(0,a.jsxs)(u.z,{onClick:()=>Q(!0),disabled:!N,children:[(0,a.jsx)(h.Z,{className:"mr-2 h-4 w-4"})," Subir Documento"]})]})]}),(0,a.jsxs)(d.Zb,{children:[(0,a.jsx)(d.Ol,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"obra-select",children:"Seleccione una Obra"}),(0,a.jsxs)(j.Ph,{value:N,onValueChange:y,children:[(0,a.jsx)(j.i4,{id:"obra-select",children:(0,a.jsx)(j.ki,{placeholder:"Seleccione una obra..."})}),(0,a.jsx)(j.Bw,{children:g.map(e=>(0,a.jsx)(j.Ql,{value:e.id,children:e.nombreFaena},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"filtro-nombre",children:"Buscar por C\xf3digo o Nombre"}),(0,a.jsx)(I.I,{id:"filtro-nombre",value:X,onChange:e=>G(e.target.value),placeholder:"Ej: P-S-01..."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"filtro-categoria",children:"Categor\xeda"}),(0,a.jsxs)(j.Ph,{value:H,onValueChange:K,children:[(0,a.jsx)(j.i4,{id:"filtro-categoria",children:(0,a.jsx)(j.ki,{})}),(0,a.jsxs)(j.Bw,{children:[(0,a.jsx)(j.Ql,{value:"all",children:"Todas"}),ee.map(e=>(0,a.jsx)(j.Ql,{value:e,children:e},e))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"filtro-estado",children:"Estado"}),(0,a.jsxs)(j.Ph,{value:Y,onValueChange:W,children:[(0,a.jsx)(j.i4,{id:"filtro-estado",children:(0,a.jsx)(j.ki,{})}),(0,a.jsxs)(j.Bw,{children:[(0,a.jsx)(j.Ql,{value:"all",children:"Todos"}),(0,a.jsx)(j.Ql,{value:"vigente",children:"Vigente"}),(0,a.jsx)(j.Ql,{value:"obsoleto",children:"Obsoleto"})]})]})]})]})}),(0,a.jsx)(d.aY,{children:(0,a.jsxs)(c.iA,{children:[(0,a.jsx)(c.xD,{children:(0,a.jsxs)(c.SC,{children:[(0,a.jsx)(c.ss,{children:"C\xf3digo"}),(0,a.jsx)(c.ss,{children:"Nombre"}),(0,a.jsx)(c.ss,{children:"Categor\xeda"}),(0,a.jsx)(c.ss,{children:"Versi\xf3n"}),(0,a.jsx)(c.ss,{children:"Estado"}),(0,a.jsx)(c.ss,{className:"text-right",children:"Opciones"})]})}),(0,a.jsx)(c.RM,{children:z?(0,a.jsx)(c.SC,{children:(0,a.jsx)(c.pj,{colSpan:6,className:"text-center",children:"Cargando documentos..."})}):et.length>0?et.map(e=>(0,a.jsxs)(c.SC,{children:[(0,a.jsx)(c.pj,{className:"font-mono",children:e.code}),(0,a.jsx)(c.pj,{className:"font-medium",children:e.name}),(0,a.jsx)(c.pj,{children:e.category}),(0,a.jsx)(c.pj,{children:e.versionAsignada}),(0,a.jsx)(c.pj,{children:(0,a.jsx)(J,{vigente:e.vigente,obsoleto:e.obsoleto})}),(0,a.jsx)(c.pj,{className:"text-right",children:(0,a.jsxs)(P,{children:[(0,a.jsx)(Z,{asChild:!0,children:(0,a.jsx)(u.z,{variant:"ghost",size:"icon",children:(0,a.jsx)(x.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(O,{align:"end",children:[e.fileUrl&&e.storagePath&&(0,a.jsx)(A,{onClick:()=>es(e),children:"Ver / Descargar PDF"}),"prevencionista"!==r&&e.vigente&&(0,a.jsx)(A,{onClick:()=>ea(e),children:"Cambiar versi\xf3n"}),(0,a.jsx)(A,{asChild:!0,children:(0,a.jsx)(E.default,{href:"/admin/documentos/historial/".concat(e.id),children:"Ver historial"})}),(0,a.jsx)(A,{asChild:!0,children:(0,a.jsx)(E.default,{href:"/admin/documentos/distribucion/".concat(e.id),children:"Evidencia de distribuci\xf3n"})}),("admin_empresa"===r||"superadmin"===r)&&(0,a.jsx)(A,{onClick:async()=>{if(!window.confirm("\xbfEliminar este documento del proyecto? Se mantendr\xe1 en el historial pero no estar\xe1 vigente."))return;let t=e(i.N$,"projectDocuments",e.id);await (0,n.r7)(t,{eliminado:!0,vigente:!1,obsoleto:!0}),m({title:"Documento Eliminado",description:"El documento ha sido marcado como eliminado."})},children:"Eliminar del proyecto"})]})]})})]},e.id)):(0,a.jsx)(c.SC,{children:(0,a.jsx)(c.pj,{colSpan:6,className:"text-center h-24",children:"No hay documentos para esta obra o que coincidan con los filtros."})})})]})})]}),"prevencionista"!==r&&e&&t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S,{open:F,onClose:()=>B(!1),documentos:_,onImport:er}),N&&(0,a.jsx)(D,{open:U,onClose:()=>Q(!1),projectId:N,companyId:t,userId:e.uid}),L&&(0,a.jsx)($,{open:T,onClose:()=>q(!1),projectDocument:L,userId:e.uid})]})]})}A.displayName=R.ck.displayName,s.forwardRef((e,t)=>{let{className:r,children:s,checked:n,...i}=e;return(0,a.jsxs)(R.oC,{ref:t,className:(0,y.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:n,...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(R.wU,{children:(0,a.jsx)(V.Z,{className:"h-4 w-4"})})}),s]})}).displayName=R.oC.displayName,s.forwardRef((e,t)=>{let{className:r,children:s,...n}=e;return(0,a.jsxs)(R.Rk,{ref:t,className:(0,y.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(R.wU,{children:(0,a.jsx)(F.Z,{className:"h-2 w-2 fill-current"})})}),s]})}).displayName=R.Rk.displayName,s.forwardRef((e,t)=>{let{className:r,inset:s,...n}=e;return(0,a.jsx)(R.__,{ref:t,className:(0,y.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",r),...n})}).displayName=R.__.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(R.Z0,{ref:t,className:(0,y.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=R.Z0.displayName},68245:function(e,t,r){"use strict";r.d(t,{X:function(){return l}});var a=r(57437),s=r(2265),n=r(9270),i=r(59559),o=r(93448);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.fC,{ref:t,className:(0,o.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...s,children:(0,a.jsx)(n.z$,{className:(0,o.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})})});l.displayName=n.fC.displayName},40279:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var a=r(57437),s=r(2265),n=r(93448);let i=s.forwardRef((e,t)=>{let{className:r,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},15291:function(e,t,r){"use strict";r.d(t,{Bw:function(){return h},Ph:function(){return c},Ql:function(){return x},i4:function(){return m},ki:function(){return u}});var a=r(57437),s=r(2265),n=r(74797),i=r(3289),o=r(47969),l=r(59559),d=r(93448);let c=n.fC;n.ZA;let u=n.B4,m=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsxs)(n.xz,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...o,children:[s,(0,a.jsx)(n.JO,{asChild:!0,children:(0,a.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=n.xz.displayName;let f=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.u_,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})});f.displayName=n.u_.displayName;let p=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.$G,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});p.displayName=n.$G.displayName;let h=s.forwardRef((e,t)=>{let{className:r,children:s,position:i="popper",...o}=e;return(0,a.jsx)(n.h_,{children:(0,a.jsxs)(n.VY,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:i,...o,children:[(0,a.jsx)(f,{}),(0,a.jsx)(n.l_,{className:(0,d.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,a.jsx)(p,{})]})})});h.displayName=n.VY.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.__,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...s})}).displayName=n.__.displayName;let x=s.forwardRef((e,t)=>{let{className:r,children:s,...i}=e;return(0,a.jsxs)(n.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(n.eT,{children:s})]})});x.displayName=n.ck.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=n.Z0.displayName},33804:function(e,t,r){"use strict";r.d(t,{RM:function(){return l},SC:function(){return d},iA:function(){return i},pj:function(){return u},ss:function(){return c},xD:function(){return o}});var a=r(57437),s=r(2265),n=r(93448);let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",r),...s})})});i.displayName="Table";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",r),...s})});o.displayName="TableHeader";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",r),...s})});l.displayName="TableBody",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...s})}).displayName="TableFooter";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s})});d.displayName="TableRow";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...s})});c.displayName="TableHead";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...s})});u.displayName="TableCell",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",r),...s})}).displayName="TableCaption"}},function(e){e.O(0,[4358,9990,6137,1211,2972,9759,3562,6008,9923,2550,1,5862,5519,5518,2971,2117,1744],function(){return e(e.s=31935)}),_N_E=e.O()}]);