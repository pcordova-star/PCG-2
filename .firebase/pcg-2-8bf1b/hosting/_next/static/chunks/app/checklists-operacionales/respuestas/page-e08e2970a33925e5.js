(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[276],{32274:function(e,s,l){Promise.resolve().then(l.bind(l,9018))},9018:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return p}});var r=l(57437),a=l(2265),i=l(12381),c=l(5485),d=l(53459),n=l(56141),t=l(27648),o=l(71245),h=l(5978),x=l(99764),j=l(79820),u=l(33804),m=l(15291),f=l(75060);function p(){let{user:e,companyId:s}=(0,o.a)(),[l,p]=(0,a.useState)([]),[N,_]=(0,a.useState)("__all__"),[b,v]=(0,a.useState)([]),[g,C]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{if(!s)return;let e=(0,h.IO)((0,h.hJ)(x.N$,"obras"),(0,h.ar)("empresaId","==",s)),l=(0,h.cf)(e,e=>{p(e.docs.map(e=>({id:e.id,...e.data()})))});return()=>l()},[s]),(0,a.useEffect)(()=>{let e;if(!s){v([]),C(!1);return}C(!0);let l=(0,h.hJ)(x.N$,"operationalChecklistRecords"),r=(0,h.ar)("companyId","==",s);e="__all__"===N?(0,h.IO)(l,r,(0,h.Xo)("filledAt","desc")):(0,h.IO)(l,r,(0,h.ar)("obraId","==",N),(0,h.Xo)("filledAt","desc"));let a=(0,h.cf)(e,e=>{v(e.docs.map(e=>({id:e.id,...e.data()}))),C(!1)},e=>{console.error("Error fetching records: ",e),C(!1)});return()=>a()},[s,N]),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("header",{className:"flex items-center gap-4",children:[(0,r.jsx)(i.z,{variant:"outline",size:"icon",asChild:!0,children:(0,r.jsx)(t.default,{href:"/checklists-operacionales",children:(0,r.jsx)(c.Z,{className:"h-4 w-4"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Registros de Checklists Operacionales"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Historial de todos los formularios completados."})]})]}),(0,r.jsxs)(j.Zb,{children:[(0,r.jsx)(j.Ol,{children:(0,r.jsx)(j.ll,{children:"Filtro por Obra"})}),(0,r.jsx)(j.aY,{children:(0,r.jsxs)("div",{className:"max-w-sm",children:[(0,r.jsx)(f._,{children:"Filtrar por obra"}),(0,r.jsxs)(m.Ph,{value:N,onValueChange:e=>_(e),children:[(0,r.jsx)(m.i4,{children:(0,r.jsx)(m.ki,{placeholder:"Todas las obras"})}),(0,r.jsxs)(m.Bw,{children:[(0,r.jsx)(m.Ql,{value:"__all__",children:"Todas las obras"}),l.map(e=>(0,r.jsx)(m.Ql,{value:e.id,children:e.nombreFaena},e.id))]})]})]})})]}),(0,r.jsxs)(j.Zb,{children:[(0,r.jsx)(j.Ol,{children:(0,r.jsx)(j.ll,{children:"Historial de Registros"})}),(0,r.jsx)(j.aY,{children:g?(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)(d.Z,{className:"animate-spin mx-auto"})}):0===b.length?(0,r.jsx)("div",{className:"text-center py-16 border-2 border-dashed rounded-lg",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"No se han completado formularios que coincidan con el filtro."})}):(0,r.jsxs)(u.iA,{children:[(0,r.jsx)(u.xD,{children:(0,r.jsxs)(u.SC,{children:[(0,r.jsx)(u.ss,{children:"Fecha"}),(0,r.jsx)(u.ss,{children:"Nombre Formulario"}),(0,r.jsx)(u.ss,{children:"Completado Por"}),(0,r.jsx)(u.ss,{children:"Sector"}),(0,r.jsx)(u.ss,{className:"text-right",children:"Acciones"})]})}),(0,r.jsx)(u.RM,{children:b.map(e=>{var s;return(0,r.jsxs)(u.SC,{children:[(0,r.jsx)(u.pj,{children:e.filledAt.toDate().toLocaleString("es-CL")}),(0,r.jsx)(u.pj,{className:"font-medium",children:e.templateTitleSnapshot}),(0,r.jsx)(u.pj,{children:e.filledByEmail}),(0,r.jsx)(u.pj,{children:(null===(s=e.header)||void 0===s?void 0:s.sector)||"N/A"}),(0,r.jsx)(u.pj,{className:"text-right",children:(0,r.jsx)(i.z,{asChild:!0,variant:"outline",size:"sm",children:(0,r.jsxs)(t.default,{href:"/checklists-operacionales/respuestas/".concat(e.id),children:[(0,r.jsx)(n.Z,{className:"mr-2 h-4 w-4"})," Ver Detalle"]})})})]},e.id)})})]})})]})]})}}},function(e){e.O(0,[4358,9990,6137,1211,2972,9759,3562,6008,9923,2550,670,2971,2117,1744],function(){return e(e.s=32274)}),_N_E=e.O()}]);