(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7320],{95762:function(e,a,t){Promise.resolve().then(t.bind(t,28865))},28865:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return I}});var r=t(57437),s=t(2265),n=t(99376),i=t(71245),l=t(88215),d=t(5978),o=t(99764),c=t(23340),u=t(12381),m=t(79820),p=t(33804),f=t(69174),x=t(74291),h=t(40279),j=t(75060),b=t(15291),g=t(23675),v=t(94589),y=t(5485),N=t(54233),w=t(53459),C=t(93448);let R={baja:"bg-blue-100 text-blue-800 border-blue-200",media:"bg-yellow-100 text-yellow-800 border-yellow-200",alta:"bg-orange-100 text-orange-800 border-orange-200",critica:"bg-red-100 text-red-800 border-red-200"},k={borrador:"bg-gray-100 text-gray-800",enviada:"bg-blue-100 text-blue-800",respondida:"bg-purple-100 text-purple-800",cerrada:"bg-green-100 text-green-800",anulada:"bg-red-100 text-red-800 line-through"};function I(){let e=(0,n.useParams)(),a=(0,n.useRouter)(),{user:t,companyId:I,role:S}=(0,i.a)(),{toast:D}=(0,c.pm)(),z=e.obraId,[_,E]=(0,s.useState)([]),[A,Z]=(0,s.useState)(null),[P,T]=(0,s.useState)([]),[F,Q]=(0,s.useState)(!0),[V,B]=(0,s.useState)(!1),[O,M]=(0,s.useState)(!1),[U,q]=(0,s.useState)(""),[$,L]=(0,s.useState)(""),[J,H]=(0,s.useState)("a_mandante"),[K,Y]=(0,s.useState)("arquitectura"),[X,G]=(0,s.useState)("media"),[W,ee]=(0,s.useState)(""),[ea,et]=(0,s.useState)(""),[er,es]=(0,s.useState)(""),[en,ei]=(0,s.useState)(""),[el,ed]=(0,s.useState)(null),[eo,ec]=(0,s.useState)(!1),[eu,em]=(0,s.useState)(null),[ep,ef]=(0,s.useState)(!1),[ex,eh]=(0,s.useState)(!1),[ej,eb]=(0,s.useState)(null),[eg,ev]=(0,s.useState)(null),[ey,eN]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(I||"superadmin"===S)&&(async()=>{let e;let a=(0,d.hJ)(o.N$,"obras");e="superadmin"===S?(0,d.IO)(a,(0,d.Xo)("nombreFaena")):(0,d.IO)(a,(0,d.ar)("empresaId","==",I),(0,d.Xo)("nombreFaena")),E((await (0,d.PL)(e)).docs.map(e=>({id:e.id,...e.data()})))})()},[I,S]),(0,s.useEffect)(()=>{if(!z){T([]),Q(!1);return}(async()=>{Q(!0);try{let e=(0,d.JU)(o.N$,"obras",z),a=(0,d.QT)(e),t=(0,l.DZ)(z),[r,s]=await Promise.all([a,t]);r.exists()&&Z({id:r.id,...r.data()}),T(s)}catch(e){console.error("Error fetching RDI data:",e),D({variant:"destructive",title:"Error",description:"No se pudieron cargar los datos de RDI."})}finally{Q(!1)}})()},[z,D]);let ew=()=>{q(""),L(""),H("a_mandante"),Y("arquitectura"),G("media"),ee(""),et(""),es(""),ei(""),ed(null),ec(!1),em(null),ef(!1)},eC=async e=>{if(e.preventDefault(),!t||!I||!z){D({variant:"destructive",title:"Error",description:"Faltan datos de sesi\xf3n."});return}if(!U||!$||!W||!ea){D({variant:"destructive",title:"Campos requeridos",description:"T\xedtulo, descripci\xf3n y datos del destinatario son obligatorios."});return}M(!0);try{let e={userId:t.uid,nombre:t.displayName||t.email||"Usuario desconocido",email:t.email||"",cargo:""},a=await (0,l.i)({companyId:I,obraId:z,titulo:U,descripcion:$,tipo:J,especialidad:K,prioridad:X,solicitante:e,destinatario:{nombre:W,email:ea,empresa:er,cargo:en},planoId:null,afectaPlazo:eo,diasAumentoSolicitados:eo?eu:null,plazoRespuestaDias:el,paraCliente:ep});T(e=>[a,...e]),D({title:"\xc9xito",description:'RDI "'.concat(a.correlativo,'" creado correctamente.')}),B(!1),ew()}catch(e){console.error("Error creating RDI:",e),D({variant:"destructive",title:"Error",description:"No se pudo crear el RDI."})}finally{M(!1)}},eR=e=>{eb(e),ev(null),eh(!0)},ek=async e=>{if(e.preventDefault(),!t||!z||!ej||!eg){D({variant:"destructive",title:"Error",description:"Faltan datos o no se ha seleccionado archivo."});return}try{eN(!0);let e=await (0,l.sd)({obraId:z,rdiId:ej.id,file:eg,subidoPorUserId:t.uid});T(a=>a.map(a=>a.id===e.id?e:a)),D({title:"Adjunto agregado",description:"El archivo se ha subido correctamente a la RDI."}),eh(!1)}catch(e){console.error("Error uploading adjunto:",e),D({variant:"destructive",title:"Error",description:"No se pudo subir el adjunto."})}finally{eN(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("header",{className:"flex items-center gap-4",children:[(0,r.jsx)(u.z,{variant:"outline",size:"icon",onClick:()=>a.back(),children:(0,r.jsx)(y.Z,{className:"h-4 w-4"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Requerimientos de Informaci\xf3n (RDI)"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Este m\xf3dulo centraliza todas las consultas y solicitudes de informaci\xf3n (RDI) de la obra, permitiendo gestionar su trazabilidad y respuestas."})]})]}),(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsx)(m.ll,{children:"Selecci\xf3n de Obra"})}),(0,r.jsx)(m.aY,{children:(0,r.jsxs)("div",{className:"max-w-md",children:[(0,r.jsx)(j._,{htmlFor:"obra-select",children:"Obra Activa"}),(0,r.jsxs)(b.Ph,{value:z,onValueChange:e=>{a.push("/rdi/".concat(e))},children:[(0,r.jsx)(b.i4,{id:"obra-select",children:(0,r.jsx)(b.ki,{placeholder:"Seleccione una obra..."})}),(0,r.jsx)(b.Bw,{children:_.map(e=>(0,r.jsx)(b.Ql,{value:e.id,children:e.nombreFaena},e.id))})]})]})})]}),(0,r.jsxs)(m.Zb,{children:[(0,r.jsxs)(m.Ol,{className:"flex flex-row items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(m.ll,{children:["Listado de RDI - ",(null==A?void 0:A.nombreFaena)||"Cargando..."]}),(0,r.jsxs)(m.SZ,{children:["Mostrando ",P.length," requerimientos registrados."]})]}),(0,r.jsxs)(x.Vq,{open:V,onOpenChange:B,children:[(0,r.jsx)(x.hg,{asChild:!0,children:(0,r.jsxs)(u.z,{onClick:()=>B(!0),disabled:!z,children:[(0,r.jsx)(N.Z,{className:"mr-2 h-4 w-4"}),"Nueva RDI"]})}),(0,r.jsx)(x.cZ,{className:"sm:max-w-2xl",children:(0,r.jsxs)("form",{onSubmit:eC,children:[(0,r.jsxs)(x.fK,{children:[(0,r.jsx)(x.$N,{children:"Nuevo Requerimiento de Informaci\xf3n"}),(0,r.jsx)(x.Be,{children:"Complete todos los campos para generar un nuevo RDI."})]}),(0,r.jsxs)("div",{className:"grid gap-4 py-4 max-h-[70vh] overflow-y-auto pr-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{htmlFor:"titulo",children:"T\xedtulo*"}),(0,r.jsx)(h.I,{id:"titulo",value:U,onChange:e=>q(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{htmlFor:"descripcion",children:"Descripci\xf3n*"}),(0,r.jsx)(g.g,{id:"descripcion",value:$,onChange:e=>L(e.target.value)})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{children:"Tipo*"}),(0,r.jsxs)(b.Ph,{value:J,onValueChange:e=>H(e),children:[(0,r.jsx)(b.i4,{children:(0,r.jsx)(b.ki,{})}),(0,r.jsxs)(b.Bw,{children:[(0,r.jsx)(b.Ql,{value:"a_mandante",children:"A Mandante"}),(0,r.jsx)(b.Ql,{value:"a_contratista",children:"A Contratista"}),(0,r.jsx)(b.Ql,{value:"interna",children:"Interna"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{children:"Especialidad*"}),(0,r.jsxs)(b.Ph,{value:K,onValueChange:e=>Y(e),children:[(0,r.jsx)(b.i4,{children:(0,r.jsx)(b.ki,{})}),(0,r.jsxs)(b.Bw,{children:[(0,r.jsx)(b.Ql,{value:"arquitectura",children:"Arquitectura"}),(0,r.jsx)(b.Ql,{value:"estructuras",children:"Estructuras"}),(0,r.jsx)(b.Ql,{value:"electrica",children:"El\xe9ctrica"}),(0,r.jsx)(b.Ql,{value:"sanitaria",children:"Sanitaria"}),(0,r.jsx)(b.Ql,{value:"climatizacion",children:"Climatizaci\xf3n"}),(0,r.jsx)(b.Ql,{value:"otra",children:"Otra"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{children:"Prioridad*"}),(0,r.jsxs)(b.Ph,{value:X,onValueChange:e=>G(e),children:[(0,r.jsx)(b.i4,{children:(0,r.jsx)(b.ki,{})}),(0,r.jsxs)(b.Bw,{children:[(0,r.jsx)(b.Ql,{value:"baja",children:"Baja"}),(0,r.jsx)(b.Ql,{value:"media",children:"Media"}),(0,r.jsx)(b.Ql,{value:"alta",children:"Alta"}),(0,r.jsx)(b.Ql,{value:"critica",children:"Cr\xedtica"})]})]})]})]}),(0,r.jsx)("h4",{className:"font-semibold pt-2 border-t mt-2",children:"Destinatario"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{htmlFor:"dest-nombre",children:"Nombre*"}),(0,r.jsx)(h.I,{id:"dest-nombre",value:W,onChange:e=>ee(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{htmlFor:"dest-email",children:"Email*"}),(0,r.jsx)(h.I,{id:"dest-email",type:"email",value:ea,onChange:e=>et(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{htmlFor:"dest-empresa",children:"Empresa"}),(0,r.jsx)(h.I,{id:"dest-empresa",value:er,onChange:e=>es(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{htmlFor:"dest-cargo",children:"Cargo"}),(0,r.jsx)(h.I,{id:"dest-cargo",value:en,onChange:e=>ei(e.target.value)})]})]}),(0,r.jsx)("h4",{className:"font-semibold pt-2 border-t mt-2",children:"Plazos e Impacto"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{htmlFor:"plazo-dias",children:"Plazo de respuesta (d\xedas)"}),(0,r.jsx)(h.I,{id:"plazo-dias",type:"number",value:null!=el?el:"",onChange:e=>ed(e.target.value?Number(e.target.value):null)})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 pt-6",children:[(0,r.jsx)(v.r,{id:"afecta-plazo",checked:eo,onCheckedChange:ec}),(0,r.jsx)(j._,{htmlFor:"afecta-plazo",children:"\xbfAfecta al plazo de la obra?"})]}),eo&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{htmlFor:"dias-aumento",children:"D\xedas de aumento solicitados"}),(0,r.jsx)(h.I,{id:"dias-aumento",type:"number",value:null!=eu?eu:"",onChange:e=>em(e.target.value?Number(e.target.value):null)})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 pt-4",children:[(0,r.jsx)(v.r,{id:"para-cliente",checked:ep,onCheckedChange:ef}),(0,r.jsx)(j._,{htmlFor:"para-cliente",children:"Hacer visible para el cliente"})]})]}),(0,r.jsxs)(x.cN,{children:[(0,r.jsx)(u.z,{type:"button",variant:"ghost",onClick:()=>B(!1),children:"Cancelar"}),(0,r.jsxs)(u.z,{type:"submit",disabled:O,children:[O&&(0,r.jsx)(w.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Crear RDI"]})]})]})})]})]}),(0,r.jsx)(m.aY,{children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(p.iA,{children:[(0,r.jsx)(p.xD,{children:(0,r.jsxs)(p.SC,{children:[(0,r.jsx)(p.ss,{children:"Correlativo"}),(0,r.jsx)(p.ss,{children:"T\xedtulo"}),(0,r.jsx)(p.ss,{children:"Especialidad"}),(0,r.jsx)(p.ss,{children:"Prioridad"}),(0,r.jsx)(p.ss,{children:"Estado"}),(0,r.jsx)(p.ss,{children:"Emisi\xf3n"}),(0,r.jsx)(p.ss,{className:"text-right",children:"Acciones"})]})}),(0,r.jsx)(p.RM,{children:F?(0,r.jsx)(p.SC,{children:(0,r.jsx)(p.pj,{colSpan:7,className:"text-center h-24",children:"Cargando..."})}):0===P.length?(0,r.jsx)(p.SC,{children:(0,r.jsx)(p.pj,{colSpan:7,className:"text-center h-24",children:"No hay RDI registrados para esta obra."})}):P.map(e=>(0,r.jsxs)(p.SC,{children:[(0,r.jsx)(p.pj,{className:"font-mono text-xs",children:e.correlativo}),(0,r.jsx)(p.pj,{className:"font-medium",children:e.titulo}),(0,r.jsx)(p.pj,{children:e.especialidad}),(0,r.jsx)(p.pj,{children:(0,r.jsx)(f.C,{variant:"outline",className:(0,C.cn)(R[e.prioridad]),children:e.prioridad})}),(0,r.jsx)(p.pj,{children:(0,r.jsx)(f.C,{variant:"outline",className:(0,C.cn)(k[e.estado]),children:e.estado})}),(0,r.jsx)(p.pj,{children:e.createdAt.toDate().toLocaleDateString()}),(0,r.jsx)(p.pj,{className:"text-right",children:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(u.z,{variant:"outline",size:"sm",onClick:()=>a.push("/rdi/".concat(z,"/").concat(e.id)),children:"Ver"}),(0,r.jsx)(u.z,{variant:"outline",size:"sm",onClick:()=>eR(e),children:"Adjuntar archivo"})]})})]},e.id))})]})})})]}),(0,r.jsx)(x.Vq,{open:ex,onOpenChange:eh,children:(0,r.jsx)(x.cZ,{className:"sm:max-w-md",children:(0,r.jsxs)("form",{onSubmit:ek,children:[(0,r.jsxs)(x.fK,{children:[(0,r.jsx)(x.$N,{children:"Adjuntar archivo a RDI"}),(0,r.jsx)(x.Be,{children:ej?"RDI ".concat(ej.correlativo," - ").concat(ej.titulo):"Seleccione un archivo para adjuntar."})]}),(0,r.jsxs)("div",{className:"space-y-4 py-2",children:[(0,r.jsx)(j._,{htmlFor:"archivo-rdi",children:"Archivo (imagen o PDF)"}),(0,r.jsx)(h.I,{id:"archivo-rdi",type:"file",accept:"image/*,application/pdf",onChange:e=>{var a,t;ev(null!==(t=null===(a=e.target.files)||void 0===a?void 0:a[0])&&void 0!==t?t:null)}})]}),(0,r.jsxs)(x.cN,{children:[(0,r.jsx)(u.z,{type:"button",variant:"ghost",onClick:()=>eh(!1),children:"Cancelar"}),(0,r.jsxs)(u.z,{type:"submit",disabled:ey||!eg,children:[ey&&(0,r.jsx)(w.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Subir adjunto"]})]})]})})})]})}},69174:function(e,a,t){"use strict";t.d(a,{C:function(){return l}});var r=t(57437);t(2265);var s=t(90535),n=t(93448);let i=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:a,variant:t,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)(i({variant:t}),a),...s})}},74291:function(e,a,t){"use strict";t.d(a,{$N:function(){return x},Be:function(){return h},Vq:function(){return d},cN:function(){return f},cZ:function(){return m},fK:function(){return p},hg:function(){return o}});var r=t(57437),s=t(2265),n=t(70001),i=t(44986),l=t(93448);let d=n.fC,o=n.xz,c=n.h_;n.x8;let u=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.aV,{ref:a,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s})});u.displayName=n.aV.displayName;let m=s.forwardRef((e,a)=>{let{className:t,children:s,...d}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(u,{}),(0,r.jsxs)(n.VY,{ref:a,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...d,children:[s,(0,r.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=n.VY.displayName;let p=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};p.displayName="DialogHeader";let f=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};f.displayName="DialogFooter";let x=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.Dx,{ref:a,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",t),...s})});x.displayName=n.Dx.displayName;let h=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.dk,{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",t),...s})});h.displayName=n.dk.displayName},15291:function(e,a,t){"use strict";t.d(a,{Bw:function(){return x},Ph:function(){return c},Ql:function(){return h},i4:function(){return m},ki:function(){return u}});var r=t(57437),s=t(2265),n=t(74797),i=t(3289),l=t(47969),d=t(59559),o=t(93448);let c=n.fC;n.ZA;let u=n.B4,m=s.forwardRef((e,a)=>{let{className:t,children:s,...l}=e;return(0,r.jsxs)(n.xz,{ref:a,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...l,children:[s,(0,r.jsx)(n.JO,{asChild:!0,children:(0,r.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=n.xz.displayName;let p=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.u_,{ref:a,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(l.Z,{className:"h-4 w-4"})})});p.displayName=n.u_.displayName;let f=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.$G,{ref:a,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})});f.displayName=n.$G.displayName;let x=s.forwardRef((e,a)=>{let{className:t,children:s,position:i="popper",...l}=e;return(0,r.jsx)(n.h_,{children:(0,r.jsxs)(n.VY,{ref:a,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...l,children:[(0,r.jsx)(p,{}),(0,r.jsx)(n.l_,{className:(0,o.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(f,{})]})})});x.displayName=n.VY.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.__,{ref:a,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s})}).displayName=n.__.displayName;let h=s.forwardRef((e,a)=>{let{className:t,children:s,...i}=e;return(0,r.jsxs)(n.ck,{ref:a,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.wU,{children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(n.eT,{children:s})]})});h.displayName=n.ck.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.Z0,{ref:a,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",t),...s})}).displayName=n.Z0.displayName},33804:function(e,a,t){"use strict";t.d(a,{RM:function(){return d},SC:function(){return o},iA:function(){return i},pj:function(){return u},ss:function(){return c},xD:function(){return l}});var r=t(57437),s=t(2265),n=t(93448);let i=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:a,className:(0,n.cn)("w-full caption-bottom text-sm",t),...s})})});i.displayName="Table";let l=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("thead",{ref:a,className:(0,n.cn)("[&_tr]:border-b",t),...s})});l.displayName="TableHeader";let d=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("tbody",{ref:a,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...s})});d.displayName="TableBody",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("tfoot",{ref:a,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s})}).displayName="TableFooter";let o=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("tr",{ref:a,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s})});o.displayName="TableRow";let c=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("th",{ref:a,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...s})});c.displayName="TableHead";let u=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("td",{ref:a,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...s})});u.displayName="TableCell",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("caption",{ref:a,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...s})}).displayName="TableCaption"},23675:function(e,a,t){"use strict";t.d(a,{g:function(){return i}});var r=t(57437),s=t(2265),n=t(93448);let i=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...s})});i.displayName="Textarea"},88215:function(e,a,t){"use strict";t.d(a,{DZ:function(){return o},Vp:function(){return c},i:function(){return d},sd:function(){return m},w6:function(){return u}});var r=t(99764),s=t(5978),n=t(60062);function i(e){return(0,s.hJ)(r.N$,"obras",e,"rdi")}async function l(e){let a=(0,s.JU)(r.N$,"obras",e,"counters","rdi");return await (0,s.i3)(r.N$,async e=>{let t=await e.get(a),r=0;if(t.exists()){var s;r=null!==(s=t.data().ultimoNumero)&&void 0!==s?s:0}let n=r+1;return e.set(a,{ultimoNumero:n},{merge:!0}),n})}async function d(e){let a=i(e.obraId),t=await l(e.obraId),r="RDI-".concat(String(t).padStart(3,"0")),n={companyId:e.companyId,obraId:e.obraId,correlativo:r,titulo:e.titulo,descripcion:e.descripcion,tipo:e.tipo,especialidad:e.especialidad,prioridad:e.prioridad,solicitante:e.solicitante,destinatario:e.destinatario,planoId:e.planoId||null,afectaPlazo:e.afectaPlazo||!1,diasAumentoSolicitados:e.diasAumentoSolicitados||null,fechaLimiteRespuesta:e.fechaLimiteRespuesta?s.EK.fromDate(e.fechaLimiteRespuesta):null,plazoRespuestaDias:e.plazoRespuestaDias||null,paraCliente:e.paraCliente||!1,estado:"enviada",respuestaTexto:null,clienteRespondio:!1,fechaRespuestaCliente:null,adjuntos:[],tieneAdjuntos:!1,emailClienteNotificado:!1,fechaNotificacionEmail:null,diasAumentoAprobados:null,closedAt:null,deleted:!1,createdAt:(0,s.Bt)(),updatedAt:(0,s.Bt)()},d=await (0,s.ET)(a,n),o=await (0,s.QT)(d);return{id:o.id,...o.data()}}async function o(e){let a=i(e),t=(0,s.IO)(a,(0,s.Xo)("createdAt","desc")),r=await (0,s.PL)(t);return r.empty?[]:r.docs.map(e=>({id:e.id,...e.data()}))}async function c(e,a){let t=(0,s.JU)(i(e),a),r=await (0,s.QT)(t);return r.exists()?{id:r.id,...r.data()}:null}async function u(e,a,t){let r=(0,s.JU)(i(e),a);await (0,s.r7)(r,{...t,updatedAt:(0,s.Bt)()})}async function m(e){let{obraId:a,rdiId:t,file:l,subidoPorUserId:d}=e,o="rdis/".concat(a,"/").concat(t,"/").concat(Date.now(),"-").concat(l.name),c=(0,n.iH)(r.IG,o);await (0,n.KV)(c,l);let u=await (0,n.Jt)(c),m={id:crypto.randomUUID(),nombreArchivo:l.name,tipo:l.type.startsWith("image/")?"imagen":"application/pdf"===l.type?"pdf":"otro",storagePath:o,downloadUrl:u,subidoPorUserId:d,fechaSubida:s.EK.now()},p=(0,s.JU)(i(a),t);await (0,s.r7)(p,{adjuntos:(0,s.vr)(m),tieneAdjuntos:!0,updatedAt:(0,s.Bt)()});let f=await (0,s.QT)(p);return{id:f.id,...f.data()}}},370:function(e,a,t){"use strict";t.d(a,{f:function(){return d}});var r=t(2265);t(54887);var s=t(37053),n=t(57437),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let t=(0,s.Z8)(`Primitive.${a}`),i=r.forwardRef((e,r)=>{let{asChild:s,...i}=e,l=s?t:a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(l,{...i,ref:r})});return i.displayName=`Primitive.${a}`,{...e,[a]:i}},{}),l=r.forwardRef((e,a)=>(0,n.jsx)(i.label,{...e,ref:a,onMouseDown:a=>{var t;a.target.closest("button, input, select, textarea")||(null===(t=e.onMouseDown)||void 0===t||t.call(e,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));l.displayName="Label";var d=l},50721:function(e,a,t){"use strict";t.d(a,{bU:function(){return w},fC:function(){return N}});var r=t(2265),s=t(6741),n=t(98575),i=t(73966),l=t(80886),d=t(6718),o=t(90420),c=t(82912),u=t(57437),m="Switch",[p,f]=(0,i.b)(m),[x,h]=p(m),j=r.forwardRef((e,a)=>{let{__scopeSwitch:t,name:i,checked:d,defaultChecked:o,required:p,disabled:f,value:h="on",onCheckedChange:j,form:b,...g}=e,[N,w]=r.useState(null),C=(0,n.e)(a,e=>w(e)),R=r.useRef(!1),k=!N||b||!!N.closest("form"),[I,S]=(0,l.T)({prop:d,defaultProp:null!=o&&o,onChange:j,caller:m});return(0,u.jsxs)(x,{scope:t,checked:I,disabled:f,children:[(0,u.jsx)(c.WV.button,{type:"button",role:"switch","aria-checked":I,"aria-required":p,"data-state":y(I),"data-disabled":f?"":void 0,disabled:f,value:h,...g,ref:C,onClick:(0,s.Mj)(e.onClick,e=>{S(e=>!e),k&&(R.current=e.isPropagationStopped(),R.current||e.stopPropagation())})}),k&&(0,u.jsx)(v,{control:N,bubbles:!R.current,name:i,value:h,checked:I,required:p,disabled:f,form:b,style:{transform:"translateX(-100%)"}})]})});j.displayName=m;var b="SwitchThumb",g=r.forwardRef((e,a)=>{let{__scopeSwitch:t,...r}=e,s=h(b,t);return(0,u.jsx)(c.WV.span,{"data-state":y(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:a})});g.displayName=b;var v=r.forwardRef((e,a)=>{let{__scopeSwitch:t,control:s,checked:i,bubbles:l=!0,...c}=e,m=r.useRef(null),p=(0,n.e)(m,a),f=(0,d.D)(i),x=(0,o.t)(s);return r.useEffect(()=>{let e=m.current;if(!e)return;let a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(f!==i&&a){let t=new Event("click",{bubbles:l});a.call(e,i),e.dispatchEvent(t)}},[f,i,l]),(0,u.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i,...c,tabIndex:-1,ref:p,style:{...c.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function y(e){return e?"checked":"unchecked"}v.displayName="SwitchBubbleInput";var N=j,w=g},5485:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});let r=(0,t(96471).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},54233:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});let r=(0,t(96471).Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},53459:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});let r=(0,t(96471).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},44986:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});let r=(0,t(96471).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[4358,9990,6137,1211,9759,3562,6008,9923,2550,1,2981,2971,2117,1744],function(){return e(e.s=95762)}),_N_E=e.O()}]);