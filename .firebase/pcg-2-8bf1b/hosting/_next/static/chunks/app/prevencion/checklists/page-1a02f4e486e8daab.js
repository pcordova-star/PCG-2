(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2137,2087,5518],{75117:function(e,t,r){Promise.resolve().then(r.bind(r,97753))},27648:function(e,t,r){"use strict";r.d(t,{default:function(){return n.a}});var a=r(72972),n=r.n(a)},97753:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return R}});var a=r(57437),n=r(2265),s=r(12381),i=r(5485),o=r(79820),l=r(5978),d=r(99764),c=r(71245),u=r(54233),f=r(53459),p=r(43728),m=r(15847),x=r(74291),h=r(40279),g=r(75060),v=r(23675),y=r(15291),j=r(69174),b=r(23340),N=r(30767);let w={titulo:"",descripcion:"",categoria:"general",secciones:[{id:crypto.randomUUID(),titulo:"Secci\xf3n 1",items:[]}]};function k(e){let{categoryFilter:t,title:r,description:i}=e,{user:k}=(0,c.a)(),{toast:A}=(0,b.pm)(),[C,R]=(0,n.useState)([]),[D,_]=(0,n.useState)(!0),[E,S]=(0,n.useState)(!1),[T,I]=(0,n.useState)(!1),[Z,z]=(0,n.useState)(w);(0,n.useEffect)(()=>{if(!k)return;_(!0);let e=(0,l.hJ)(d.N$,"checklistTemplates"),r=Array.isArray(t)?"in":"==",a=(0,l.IO)(e,(0,l.ar)("categoria",r,t),(0,l.Xo)("createdAt","desc")),n=(0,l.cf)(a,e=>{R(e.docs.map(e=>({id:e.id,...e.data()}))),_(!1)},e=>{console.error("Error fetching templates:",e),A({variant:"destructive",title:"Error de Carga",description:"No se pudieron cargar las plantillas. Verifique los \xedndices de Firestore."}),_(!1)});return()=>n()},[k,A,t]);let O=e=>{let r=Array.isArray(t)?t[0]:t;z(e||{...w,categoria:r}),S(!0)},P=async()=>{if(!k||!Z.titulo){A({variant:"destructive",title:"Error",description:"El t\xedtulo es obligatorio."});return}I(!0);try{if(Z.id){let e=(0,l.JU)(d.N$,"checklistTemplates",Z.id);await (0,l.r7)(e,{...Z,updatedAt:(0,l.Bt)()}),A({title:"Plantilla actualizada"})}else await (0,l.ET)((0,l.hJ)(d.N$,"checklistTemplates"),{...Z,createdBy:k.uid,createdAt:(0,l.Bt)()}),A({title:"Plantilla creada"});S(!1)}catch(e){console.error(e),A({variant:"destructive",title:"Error",description:"No se pudo guardar la plantilla."})}finally{I(!1)}},M=async e=>{try{await (0,l.oe)((0,l.JU)(d.N$,"checklistTemplates",e)),A({title:"Plantilla eliminada"})}catch(e){console.error(e),A({variant:"destructive",title:"Error",description:"No se pudo eliminar la plantilla."})}},V=(e,t)=>{z(r=>({...r,[e]:t}))};return(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{className:"flex-row justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.ll,{children:r}),(0,a.jsx)(o.SZ,{children:i})]}),(0,a.jsxs)(s.z,{onClick:()=>O(),children:[(0,a.jsx)(u.Z,{className:"mr-2"}),"Nueva Plantilla"]})]}),(0,a.jsx)(o.aY,{children:D?(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)(f.Z,{className:"animate-spin mx-auto"})}):0===C.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground border-2 border-dashed rounded-lg",children:(0,a.jsx)("p",{children:"No hay plantillas en esta categor\xeda. \xa1Crea la primera!"})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(e=>(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsx)(o.ll,{className:"text-lg",children:e.titulo}),(0,a.jsx)(j.C,{variant:"outline",children:e.categoria})]}),(0,a.jsx)(o.SZ,{children:e.descripcion})]}),(0,a.jsxs)(o.eW,{className:"flex justify-end gap-2",children:[(0,a.jsxs)(N.aR,{children:[(0,a.jsx)(N.vW,{asChild:!0,children:(0,a.jsx)(s.z,{variant:"ghost",size:"icon",className:"text-destructive",children:(0,a.jsx)(p.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(N._T,{children:[(0,a.jsxs)(N.fY,{children:[(0,a.jsx)(N.f$,{children:"\xbfEliminar plantilla?"}),(0,a.jsx)(N.yT,{children:"Esta acci\xf3n no se puede deshacer."})]}),(0,a.jsxs)(N.xo,{children:[(0,a.jsx)(N.le,{children:"Cancelar"}),(0,a.jsx)(N.OL,{onClick:()=>M(e.id),className:"bg-destructive hover:bg-destructive/90",children:"Eliminar"})]})]})]}),(0,a.jsxs)(s.z,{variant:"outline",size:"sm",onClick:()=>O(e),children:[(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Editar"]})]})]},e.id))})}),(0,a.jsx)(x.Vq,{open:E,onOpenChange:S,children:(0,a.jsxs)(x.cZ,{className:"sm:max-w-lg",children:[(0,a.jsxs)(x.fK,{children:[(0,a.jsx)(x.$N,{children:Z.id?"Editar Plantilla":"Crear Nueva Plantilla"}),(0,a.jsx)(x.Be,{children:"Define la estructura de tu checklist."})]}),(0,a.jsxs)("div",{className:"py-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g._,{htmlFor:"titulo",children:"T\xedtulo*"}),(0,a.jsx)(h.I,{id:"titulo",value:Z.titulo||"",onChange:e=>V("titulo",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g._,{htmlFor:"descripcion",children:"Descripci\xf3n"}),(0,a.jsx)(v.g,{id:"descripcion",value:Z.descripcion||"",onChange:e=>V("descripcion",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g._,{htmlFor:"categoria",children:"Categor\xeda*"}),(0,a.jsxs)(y.Ph,{value:Z.categoria||"general",onValueChange:e=>V("categoria",e),children:[(0,a.jsx)(y.i4,{id:"categoria",children:(0,a.jsx)(y.ki,{})}),(0,a.jsxs)(y.Bw,{children:[(0,a.jsx)(y.Ql,{value:"general",children:"General"}),(0,a.jsx)(y.Ql,{value:"operaciones",children:"Operaciones"}),(0,a.jsx)(y.Ql,{value:"prevencion",children:"Prevenci\xf3n de Riesgos"})]})]})]}),(0,a.jsx)("div",{className:"text-center p-4 border-dashed border-2 rounded-md",children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"La edici\xf3n de secciones e \xedtems del checklist se implementar\xe1 pr\xf3ximamente."})})]}),(0,a.jsxs)(x.cN,{children:[(0,a.jsx)(s.z,{variant:"ghost",onClick:()=>S(!1),children:"Cancelar"}),(0,a.jsxs)(s.z,{onClick:P,disabled:T,children:[T&&(0,a.jsx)(f.Z,{className:"mr-2 animate-spin"}),"Guardar Plantilla"]})]})]})})]})}var A=r(99376),C=r(27648);function R(){let e=(0,A.useRouter)(),{role:t,loading:r}=(0,c.a)(),o=["prevencionista","admin_empresa","superadmin"];return((0,n.useEffect)(()=>{r||o.includes(t)||e.replace("/dashboard")},[r,t,e,o]),r||!o.includes(t))?(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)(f.Z,{className:"h-8 w-8 animate-spin"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("header",{className:"flex items-center gap-4",children:[(0,a.jsx)(s.z,{variant:"outline",size:"icon",asChild:!0,children:(0,a.jsx)(C.default,{href:"/prevencion",children:(0,a.jsx)(i.Z,{})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Listas de Chequeo de Prevenci\xf3n"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Plantillas para inspecciones, auditor\xedas y controles de seguridad."})]})]}),(0,a.jsx)(k,{categoryFilter:"prevencion",title:"Plantillas de Prevenci\xf3n de Riesgos",description:"Listado de plantillas de checklist exclusivas para el \xe1rea de prevenci\xf3n."})]})}},30767:function(e,t,r){"use strict";r.d(t,{OL:function(){return g},_T:function(){return f},aR:function(){return l},f$:function(){return x},fY:function(){return p},le:function(){return v},vW:function(){return d},xo:function(){return m},yT:function(){return h}});var a=r(57437),n=r(2265),s=r(7880),i=r(93448),o=r(12381);let l=s.fC,d=s.xz,c=s.h_,u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.aV,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...n,ref:t})});u.displayName=s.aV.displayName;let f=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsx)(s.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...n})]})});f.displayName=s.VY.displayName;let p=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...r})};p.displayName="AlertDialogHeader";let m=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};m.displayName="AlertDialogFooter";let x=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold",r),...n})});x.displayName=s.Dx.displayName;let h=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...n})});h.displayName=s.dk.displayName;let g=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.aU,{ref:t,className:(0,i.cn)((0,o.d)(),r),...n})});g.displayName=s.aU.displayName;let v=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.$j,{ref:t,className:(0,i.cn)((0,o.d)({variant:"outline"}),"mt-2 sm:mt-0",r),...n})});v.displayName=s.$j.displayName},69174:function(e,t,r){"use strict";r.d(t,{C:function(){return o}});var a=r(57437);r(2265);var n=r(90535),s=r(93448);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:r,...n}=e;return(0,a.jsx)("div",{className:(0,s.cn)(i({variant:r}),t),...n})}},12381:function(e,t,r){"use strict";r.d(t,{d:function(){return l},z:function(){return d}});var a=r(57437),n=r(2265),s=r(37053),i=r(90535),o=r(93448);let l=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:r,variant:n,size:i,asChild:d=!1,...c}=e,u=d?s.g7:"button";return(0,a.jsx)(u,{className:(0,o.cn)(l({variant:n,size:i,className:r})),ref:t,...c})});d.displayName="Button"},79820:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},eW:function(){return u},ll:function(){return l}});var a=r(57437),n=r(2265),s=r(93448);let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});i.displayName="Card";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...n})});o.displayName="CardHeader";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});l.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...n})});c.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...n})});u.displayName="CardFooter"},74291:function(e,t,r){"use strict";r.d(t,{$N:function(){return x},Be:function(){return h},Vq:function(){return l},cN:function(){return m},cZ:function(){return f},fK:function(){return p},hg:function(){return d}});var a=r(57437),n=r(2265),s=r(70001),i=r(44986),o=r(93448);let l=s.fC,d=s.xz,c=s.h_;s.x8;let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.aV,{ref:t,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...n})});u.displayName=s.aV.displayName;let f=n.forwardRef((e,t)=>{let{className:r,children:n,...l}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(s.VY,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...l,children:[n,(0,a.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=s.VY.displayName;let p=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};p.displayName="DialogHeader";let m=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};m.displayName="DialogFooter";let x=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.Dx,{ref:t,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",r),...n})});x.displayName=s.Dx.displayName;let h=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.dk,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...n})});h.displayName=s.dk.displayName},40279:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var a=r(57437),n=r(2265),s=r(93448);let i=n.forwardRef((e,t)=>{let{className:r,type:n,...i}=e;return(0,a.jsx)("input",{type:n,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},75060:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var a=r(57437),n=r(2265),s=r(370),i=r(90535),o=r(93448);let l=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.f,{ref:t,className:(0,o.cn)(l(),r),...n})});d.displayName=s.f.displayName},15291:function(e,t,r){"use strict";r.d(t,{Bw:function(){return x},Ph:function(){return c},Ql:function(){return h},i4:function(){return f},ki:function(){return u}});var a=r(57437),n=r(2265),s=r(74797),i=r(3289),o=r(47969),l=r(59559),d=r(93448);let c=s.fC;s.ZA;let u=s.B4,f=n.forwardRef((e,t)=>{let{className:r,children:n,...o}=e;return(0,a.jsxs)(s.xz,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...o,children:[n,(0,a.jsx)(s.JO,{asChild:!0,children:(0,a.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});f.displayName=s.xz.displayName;let p=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.u_,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...n,children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})});p.displayName=s.u_.displayName;let m=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.$G,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...n,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});m.displayName=s.$G.displayName;let x=n.forwardRef((e,t)=>{let{className:r,children:n,position:i="popper",...o}=e;return(0,a.jsx)(s.h_,{children:(0,a.jsxs)(s.VY,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:i,...o,children:[(0,a.jsx)(p,{}),(0,a.jsx)(s.l_,{className:(0,d.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,a.jsx)(m,{})]})})});x.displayName=s.VY.displayName,n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.__,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...n})}).displayName=s.__.displayName;let h=n.forwardRef((e,t)=>{let{className:r,children:n,...i}=e;return(0,a.jsxs)(s.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(s.wU,{children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(s.eT,{children:n})]})});h.displayName=s.ck.displayName,n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",r),...n})}).displayName=s.Z0.displayName},23675:function(e,t,r){"use strict";r.d(t,{g:function(){return i}});var a=r(57437),n=r(2265),s=r(93448);let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...n})});i.displayName="Textarea"},71245:function(e,t,r){"use strict";r.d(t,{H:function(){return f},a:function(){return p}});var a=r(57437),n=r(43301),s=r(2265),i=r(99764),o=r(99376),l=r(5978);async function d(e){var t;let r=i.N$,a=null===(t=e.email)||void 0===t?void 0:t.toLowerCase().trim();if(!a)return{role:"none",companyId:null};let n=(0,l.IO)((0,l.hJ)(r,"invitacionesUsuarios"),(0,l.ar)("email","==",a),(0,l.ar)("estado","==","pendiente_auth"),(0,l.b9)(1)),s=await (0,l.PL)(n);if(s.empty)return console.log("No hay invitaci\xf3n pendiente para ".concat(a,".")),{role:"none",companyId:null};let o=s.docs[0],d=o.data(),c=(0,l.JU)(r,"users",e.uid),u=(0,l.qs)(r);return u.set(c,{nombre:d.nombre||e.displayName,email:a,role:d.roleDeseado,empresaId:d.empresaId,activo:!0,createdAt:(0,l.Bt)(),updatedAt:(0,l.Bt)()},{merge:!0}),u.update(o.ref,{estado:"activado",uid:e.uid,activatedAt:(0,l.Bt)()}),await u.commit(),console.log("Usuario ".concat(a," activado con rol ").concat(d.roleDeseado," en empresa ").concat(d.empresaId,".")),{role:d.roleDeseado,companyId:d.empresaId}}async function c(e){}let u=(0,s.createContext)(void 0);function f(e){let{children:t}=e,[r,f]=(0,s.useState)(null),[p,m]=(0,s.useState)("none"),[x,h]=(0,s.useState)(null),[g,v]=(0,s.useState)(null),[y,j]=(0,s.useState)(!0),b=(0,o.useRouter)(),N=(0,o.usePathname)();async function w(e,t){try{await (0,n.e5)(i.lX,e,t)}catch(e){if("auth/invalid-credential"===e.code||"auth/wrong-password"===e.code||"auth/user-not-found"===e.code)throw Error("Credenciales inv\xe1lidas. Por favor, revisa tu correo y contrase\xf1a.");if("auth/too-many-requests"===e.code)throw Error("Demasiados intentos fallidos. Por seguridad, el acceso desde este dispositivo ha sido bloqueado temporalmente.");throw console.error("Error de login no manejado:",e),Error("Ocurri\xf3 un error inesperado al iniciar sesi\xf3n.")}}async function k(){try{await (0,n.w7)(i.lX),f(null),m("none"),h(null),v(null),b.push("/")}catch(e){console.error("Error al cerrar sesi\xf3n",e)}}return(0,s.useEffect)(()=>{let e=(0,n.Aj)(i.lX,async e=>{if(e){await c(e);let t=(0,l.JU)(i.N$,"users",e.uid),r=await (0,l.QT)(t),a="none",n=null,s=!1;if(r.exists()){let e=r.data();e.role&&void 0!==e.empresaId&&(a=e.role,n=e.empresaId,s=!0===e.mustChangePassword)}if("none"===a){let t=await d(e);a=t.role,n=t.companyId,s=!0}m(a),h(n),f(e);let o="/cambiar-password"===N;if(s&&!o)b.replace("/cambiar-password");else if(!s){if("none"===a)b.replace("/sin-acceso");else if(N.startsWith("/login")||"/"===N||o){let e="cliente"===a?"/cliente":"contratista"===a?"/cumplimiento/contratista":"/dashboard";b.replace(e)}}}else f(null),m("none"),h(null),v(null);j(!1)});return()=>e()},[b,N]),(0,s.useEffect)(()=>{if(x){let e=(0,l.JU)(i.N$,"companies",x),t=(0,n.Aj)(i.lX,t=>{t&&(0,l.QT)(e).then(e=>{e.exists()?v({id:e.id,...e.data()}):v(null)})});return()=>t()}v(null)},[x]),(0,a.jsx)(u.Provider,{value:{user:r,role:p,companyId:x,company:g,loading:y,login:w,logout:k},children:t})}function p(){let e=(0,s.useContext)(u);if(!e)throw Error("useAuth debe usarse dentro de un AuthProvider");return e}},23340:function(e,t,r){"use strict";r.d(t,{pm:function(){return f}});var a=r(2265);let n=0,s=new Map,i=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=a.useState(d);return a.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},99764:function(e,t,r){"use strict";let a,n,s,i,o;r.d(t,{IG:function(){return i},N$:function(){return s},lX:function(){return n},x2:function(){return o}});var l=r(738),d=r(43301),c=r(5978),u=r(60062),f=r(13491);let p={apiKey:"AIzaSyBfMp_dH9XhFSXEeMxY-Cdy8MDRIgWrxR0",authDomain:"pcg-2-8bf1b.firebaseapp.com",projectId:"pcg-2-8bf1b",storageBucket:"pcg-2-8bf1b.appspot.com",messagingSenderId:"1073834543546",appId:"1:1073834543546:web:2f85a4a8350280f8589737"};for(let e in p)if(Object.prototype.hasOwnProperty.call(p,e)&&!p[e]){let t=e.replace(/([A-Z])/g,"_$1").toUpperCase(),r="NEXT_PUBLIC_FIREBASE_".concat(t);throw Error("Error de configuraci\xf3n del cliente: La variable de entorno Firebase '".concat(r,"' no est\xe1 definida o est\xe1 vac\xeda. ")+"Aseg\xfarate de que est\xe9 configurada en tu archivo .env.local o en las variables de entorno de producci\xf3n.")}a=(0,l.C6)().length?(0,l.Mq)():(0,l.ZF)(p),n=(0,d.v0)(a),s=(0,c.ad)(a),i=(0,u.cF)(a),o=(0,f.$C)(a,"us-central1")},93448:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var a=r(61994),n=r(53335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}},7880:function(e,t,r){"use strict";r.d(t,{aU:function(){return O},$j:function(){return P},VY:function(){return z},dk:function(){return V},aV:function(){return Z},h_:function(){return I},fC:function(){return S},Dx:function(){return M},xz:function(){return T}});var a=r(2265),n=r(73966),s=r(98575),i=r(70001),o=r(6741),l=r(57437),d=Symbol("radix.slottable"),c="AlertDialog",[u,f]=(0,n.b)(c,[i.p8]),p=(0,i.p8)(),m=e=>{let{__scopeAlertDialog:t,...r}=e,a=p(t);return(0,l.jsx)(i.fC,{...a,...r,modal:!0})};m.displayName=c;var x=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,n=p(r);return(0,l.jsx)(i.xz,{...n,...a,ref:t})});x.displayName="AlertDialogTrigger";var h=e=>{let{__scopeAlertDialog:t,...r}=e,a=p(t);return(0,l.jsx)(i.h_,{...a,...r})};h.displayName="AlertDialogPortal";var g=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,n=p(r);return(0,l.jsx)(i.aV,{...n,...a,ref:t})});g.displayName="AlertDialogOverlay";var v="AlertDialogContent",[y,j]=u(v),b=function(e){let t=({children:e})=>(0,l.jsx)(l.Fragment,{children:e});return t.displayName=`${e}.Slottable`,t.__radixId=d,t}("AlertDialogContent"),N=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,children:n,...d}=e,c=p(r),u=a.useRef(null),f=(0,s.e)(t,u),m=a.useRef(null);return(0,l.jsx)(i.jm,{contentName:v,titleName:w,docsSlug:"alert-dialog",children:(0,l.jsx)(y,{scope:r,cancelRef:m,children:(0,l.jsxs)(i.VY,{role:"alertdialog",...c,...d,ref:f,onOpenAutoFocus:(0,o.Mj)(d.onOpenAutoFocus,e=>{var t;e.preventDefault(),null===(t=m.current)||void 0===t||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,l.jsx)(b,{children:n}),(0,l.jsx)(E,{contentRef:u})]})})})});N.displayName=v;var w="AlertDialogTitle",k=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,n=p(r);return(0,l.jsx)(i.Dx,{...n,...a,ref:t})});k.displayName=w;var A="AlertDialogDescription",C=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,n=p(r);return(0,l.jsx)(i.dk,{...n,...a,ref:t})});C.displayName=A;var R=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,n=p(r);return(0,l.jsx)(i.x8,{...n,...a,ref:t})});R.displayName="AlertDialogAction";var D="AlertDialogCancel",_=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,{cancelRef:n}=j(D,r),o=p(r),d=(0,s.e)(t,n);return(0,l.jsx)(i.x8,{...o,...a,ref:d})});_.displayName=D;var E=e=>{let{contentRef:t}=e,r="`".concat(v,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(v,"` by passing a `").concat(A,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(v,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return a.useEffect(()=>{var e;document.getElementById(null===(e=t.current)||void 0===e?void 0:e.getAttribute("aria-describedby"))||console.warn(r)},[r,t]),null},S=m,T=x,I=h,Z=g,z=N,O=R,P=_,M=k,V=C},370:function(e,t,r){"use strict";r.d(t,{f:function(){return l}});var a=r(2265);r(54887);var n=r(37053),s=r(57437),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,n.Z8)(`Primitive.${t}`),i=a.forwardRef((e,a)=>{let{asChild:n,...i}=e,o=n?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(o,{...i,ref:a})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{}),o=a.forwardRef((e,t)=>(0,s.jsx)(i.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));o.displayName="Label";var l=o},5485:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(96471).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},54233:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(96471).Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},53459:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(96471).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},15847:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(96471).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},43728:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(96471).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},44986:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(96471).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[4358,9990,6137,1211,2972,9759,3562,6008,9923,2550,1,2971,2117,1744],function(){return e(e.s=75117)}),_N_E=e.O()}]);