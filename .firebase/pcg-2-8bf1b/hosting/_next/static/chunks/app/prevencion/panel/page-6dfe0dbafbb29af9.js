(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4304],{54478:function(e,a,s){Promise.resolve().then(s.bind(s,55830))},55830:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return C}});var r=s(57437),t=s(2265),i=s(79820),n=s(69174),l=s(12381),c=s(5255),o=s(91230),d=s(81475),h=s(37713),u=s(12032);let x=(0,s(96471).Z)("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);var m=s(56148),p=s(5485),f=s(5978),g=s(99764),b=s(71245),j=s(27648),y=s(99376);let v=e=>{let{icon:a,title:s,value:t,description:n,colorClass:l}=e;return(0,r.jsxs)(i.Zb,{className:"".concat(l," border-l-4"),children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(i.ll,{className:"text-sm font-medium",children:s}),(0,r.jsx)(a,{className:"h-5 w-5 text-muted-foreground"})]}),(0,r.jsxs)(i.aY,{children:[(0,r.jsx)("div",{className:"text-4xl font-bold",children:t}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:n})]})]})},N=e=>{let{tareas:a}=e,s={alta:"bg-red-100 text-red-800",media:"bg-yellow-100 text-yellow-800",baja:"bg-blue-100 text-blue-800"};return(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{children:[(0,r.jsx)(i.ll,{children:"Lo que debes hacer hoy"}),(0,r.jsx)(i.SZ,{children:"Tareas urgentes que requieren tu atenci\xf3n inmediata."})]}),(0,r.jsx)(i.aY,{className:"space-y-3",children:0===a.length?(0,r.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,r.jsx)(c.Z,{className:"mx-auto h-12 w-12 text-green-500"}),(0,r.jsx)("p",{className:"mt-2 font-semibold",children:"\xa1Todo al d\xeda!"}),(0,r.jsx)("p",{className:"text-sm",children:"No tienes tareas urgentes para hoy."})]}):a.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold",children:e.titulo}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,r.jsx)("span",{children:e.tipo.charAt(0).toUpperCase()+e.tipo.slice(1)}),(0,r.jsxs)(n.C,{variant:"outline",className:s[e.prioridad],children:["Prioridad ",e.prioridad]})]})]}),(0,r.jsx)(l.z,{asChild:!0,size:"sm",onClick:()=>console.log("Ir a tarea",e.id),children:(0,r.jsxs)(j.default,{href:"/prevencion/formularios-generales",children:["Ir a tarea ",(0,r.jsx)(o.Z,{className:"ml-2 h-4 w-4"})]})})]},e.id))})]})},k=e=>{let{tarea:a}=e,s={pendiente:{color:"border-yellow-500 bg-yellow-50",label:"Pendiente",icon:d.Z},en_progreso:{color:"border-blue-500 bg-blue-50",label:"En Progreso",icon:h.Z},resuelta:{color:"border-green-500 bg-green-50",label:"Resuelta",icon:c.Z},vencida:{color:"border-red-500 bg-red-50",label:"Vencida",icon:u.Z}}[a.estado];return(0,r.jsxs)(i.Zb,{className:"transition-all hover:shadow-md ".concat(s.color),children:[(0,r.jsxs)(i.Ol,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsx)(i.ll,{className:"text-base",children:a.titulo}),(0,r.jsxs)(n.C,{variant:"outline",className:"".concat(s.color," text-xs"),children:[(0,r.jsx)(s.icon,{className:"mr-1 h-3 w-3"}),s.label]})]}),(0,r.jsx)(i.SZ,{children:a.descripcion})]}),(0,r.jsxs)(i.aY,{className:"text-xs text-muted-foreground space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Tipo:"})," ",a.tipo]}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Prioridad:"})," ",a.prioridad]})]}),(0,r.jsx)("div",{className:"flex justify-between",children:(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Fecha L\xedmite:"})," ",a.fechaLimite.toDate().toLocaleDateString("es-CL")]})})]})]})};function C(){let{user:e,companyId:a}=(0,b.a)(),s=(0,y.useRouter)(),[n,c]=(0,t.useState)({charlasAtrasadas:0,charlasProximas:0,iperCriticosSinCharla:0,trabajadoresSinInduccion:0}),[o,d]=(0,t.useState)([]),[h,j]=(0,t.useState)([]);(0,t.useEffect)(()=>{a&&(async()=>{let e=new Date;e.setHours(0,0,0,0);let a=(0,f.IO)((0,f.hJ)(g.N$,"charlas"),(0,f.ar)("estado","==","borrador"));d((await (0,f.PL)(a)).docs.map(e=>({id:e.id,...e.data()})).filter(a=>a.fechaRealizacion&&a.fechaRealizacion.toDate()<e).map(e=>({id:e.id,obraId:e.obraId,tipo:"charla",titulo:"Realizar charla atrasada: ".concat(e.titulo),descripcion:'La charla sobre "'.concat(e.tarea,'" estaba programada para el ').concat(e.fechaRealizacion.toDate().toLocaleDateString()," y sigue en borrador."),relacionId:e.id,estado:"vencida",prioridad:"alta",fechaCreacion:e.fechaCreacion,fechaLimite:e.fechaRealizacion,creadaAutomaticamente:e.generadaAutomaticamente,responsableUid:e.creadaPorUid})))})()},[a]);let C=[{title:"Charlas atrasadas",value:n.charlasAtrasadas,description:"Charlas en borrador con fecha vencida.",icon:x,colorClass:"border-red-500 bg-red-50"},{title:"Charlas de esta semana",value:n.charlasProximas,description:"Programadas para los pr\xf3ximos 7 d\xedas.",icon:x,colorClass:"border-blue-500 bg-blue-50"},{title:"IPER cr\xedticos sin charla",value:n.iperCriticosSinCharla,description:"Riesgos altos que no tienen charla asociada.",icon:u.Z,colorClass:"border-yellow-500 bg-yellow-50"},{title:"Trabajadores sin inducci\xf3n",value:n.trabajadoresSinInduccion,description:"Personal nuevo pendiente de inducci\xf3n.",icon:m.Z,colorClass:"border-orange-500 bg-orange-50"}];return(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("header",{className:"flex items-start gap-4",children:[(0,r.jsx)(l.z,{variant:"outline",size:"icon",onClick:()=>s.push("/prevencion"),className:"flex-shrink-0",children:(0,r.jsx)(p.Z,{className:"h-4 w-4"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"Panel del Prevencionista"}),(0,r.jsx)("p",{className:"mt-2 text-lg text-muted-foreground",children:"Gesti\xf3n diaria de riesgos, charlas y cumplimiento operativo."})]})]}),(0,r.jsx)("section",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:C.map(e=>(0,r.jsx)(v,{...e},e.title))}),(0,r.jsxs)("section",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 items-start",children:[(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsx)(N,{tareas:o})}),(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{children:[(0,r.jsx)(i.ll,{children:"Historial de Tareas"}),(0,r.jsx)(i.SZ,{children:"Listado general de todas tus tareas pendientes, en progreso y resueltas."})]}),(0,r.jsx)(i.aY,{className:"space-y-4",children:h.length>0?h.map(e=>(0,r.jsx)(k,{tarea:e},e.id)):(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No hay m\xe1s tareas en el historial."})})]})})]})]})}},69174:function(e,a,s){"use strict";s.d(a,{C:function(){return l}});var r=s(57437);s(2265);var t=s(90535),i=s(93448);let n=(0,t.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:a,variant:s,...t}=e;return(0,r.jsx)("div",{className:(0,i.cn)(n({variant:s}),a),...t})}},5485:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});let r=(0,s(96471).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5255:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});let r=(0,s(96471).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},81475:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});let r=(0,s(96471).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},37713:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});let r=(0,s(96471).Z)("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]])},12032:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});let r=(0,s(96471).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},56148:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});let r=(0,s(96471).Z)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]])}},function(e){e.O(0,[4358,9990,6137,1211,2972,3288,2971,2117,1744],function(){return e(e.s=54478)}),_N_E=e.O()}]);