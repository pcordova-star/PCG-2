(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1239],{11979:function(e,a,s){Promise.resolve().then(s.bind(s,33319))},33319:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return ed}});var i=s(57437),o=s(2265),r=s(93448),n=s(12381),t=s(91120),l=s(46977),c=s(16994),d=s(36086),m=s(23846),p=s(16049),u=s(67541),g=s(87928),h=s(46271),x=s(79647),b=s(75118),f=s(5485),j=s(99376);let v=[{id:"info-general",label:"Informaci\xf3n General",icon:t.Z},{id:"objetivo",label:"Objetivo del Programa",icon:l.Z},{id:"organizacion",label:"Organizaci\xf3n Interna",icon:c.Z},{id:"iper",label:"Identificaci\xf3n de Peligros (IPER)",icon:d.Z},{id:"medidas-control",label:"Medidas de Control",icon:m.Z},{id:"charlas",label:"Charlas y Capacitaci\xf3n",icon:p.Z},{id:"capacitacion-ds44",label:"Plan de Capacitaci\xf3n DS 44",icon:u.Z},{id:"procedimientos",label:"Procedimientos de Trabajo Seguro",icon:g.Z},{id:"protocolos-emergencia",label:"Protocolos de Emergencia",icon:h.Z},{id:"fiscalizacion",label:"Plan de Fiscalizaci\xf3n Interna",icon:x.Z},{id:"registro",label:"Registro y Seguimiento",icon:g.Z},{id:"enfoque-genero",label:"Enfoque de G\xe9nero (DS 44)",icon:b.Z}];function P(e){let{activeSection:a,setActiveSection:s}=e,o=(0,j.useRouter)();return(0,i.jsx)("aside",{className:"hidden md:block sticky top-24",children:(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsxs)(n.z,{variant:"outline",size:"sm",className:"mb-4",onClick:()=>o.push("/prevencion"),children:[(0,i.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Volver a Prevenci\xf3n"]}),(0,i.jsx)("h3",{className:"text-sm font-semibold text-muted-foreground px-4",children:"Secciones del PPR"}),v.map(e=>(0,i.jsxs)(n.z,{variant:"ghost",onClick:()=>s(e.id),className:(0,r.cn)("justify-start gap-2",a===e.id&&"bg-accent text-accent-foreground"),children:[(0,i.jsx)(e.icon,{className:"h-4 w-4"}),(0,i.jsx)("span",{children:e.label})]},e.id))]})})}var N=s(79820);function C(e){let{title:a,description:s,children:o}=e;return(0,i.jsxs)("section",{children:[(0,i.jsxs)("header",{className:"mb-6",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:a}),(0,i.jsx)("p",{className:"mt-2 text-lg text-muted-foreground",children:s})]}),(0,i.jsx)(N.Zb,{children:(0,i.jsx)(N.aY,{className:"p-6",children:o})})]})}function y(e){let{label:a,value:s}=e;return(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:a}),(0,i.jsx)("div",{className:"w-full rounded-md border border-dashed bg-muted/50 p-2 text-sm text-foreground",children:s})]})}function R(e){var a,s;let{obra:o}=e;return o?(0,i.jsx)(C,{title:"Informaci\xf3n General de la Obra",description:"Datos base del Programa de Prevenci\xf3n de Riesgos, obtenidos desde el m\xf3dulo de Obras.",children:(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsx)(y,{label:"Nombre de la obra",value:o.nombreFaena}),(0,i.jsx)(y,{label:"Ubicaci\xf3n",value:o.direccion||"No especificada"}),(0,i.jsx)(y,{label:"Empresa mandante",value:o.mandanteRazonSocial||"No especificada"}),(0,i.jsx)(y,{label:"Empresa contratista",value:(null===(a=o.empresa)||void 0===a?void 0:a.nombre)||"Constructora PCG Ltda."}),(0,i.jsx)(y,{label:"Fecha de inicio",value:o.fechaInicio?new Date(o.fechaInicio+"T00:00:00").toLocaleDateString("es-CL"):"No especificada"}),(0,i.jsx)(y,{label:"Fecha de t\xe9rmino estimada",value:o.fechaTermino?new Date(o.fechaTermino+"T00:00:00").toLocaleDateString("es-CL"):"No especificada"}),(0,i.jsx)(y,{label:"Dotaci\xf3n proyectada (promedio)",value:(null===(s=o.dotacionProyectada)||void 0===s?void 0:s.toString())||"No especificada"}),(0,i.jsx)(y,{label:"Prevencionista responsable",value:o.prevencionistaNombre||"No especificado"})]})}):(0,i.jsx)(C,{title:"Informaci\xf3n General de la Obra",description:"Datos base del Programa de Prevenci\xf3n de Riesgos. Seleccione una obra para cargar los datos.",children:(0,i.jsx)("p",{className:"text-muted-foreground",children:"Seleccione una obra para ver la informaci\xf3n."})})}function S(){return(0,i.jsx)(C,{title:"Objetivo del Programa",description:"Declaraci\xf3n de principios y metas del Programa de Prevenci\xf3n de Riesgos de la obra.",children:(0,i.jsxs)("div",{className:"prose prose-sm max-w-none text-muted-foreground",children:[(0,i.jsx)("p",{children:"El presente Programa de Prevenci\xf3n de Riesgos (PPR) tiene como objetivo principal establecer un sistema de gesti\xf3n proactivo para identificar, evaluar y controlar los riesgos laborales inherentes a las actividades de la obra, con el fin de proteger la vida y salud de todos los trabajadores, tanto propios como de empresas contratistas y subcontratistas."}),(0,i.jsx)("p",{children:"Los objetivos espec\xedficos de este programa son:"}),(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"Prevenir la ocurrencia de accidentes del trabajo y enfermedades profesionales."}),(0,i.jsx)("li",{children:"Dar cumplimiento a la normativa legal vigente, incluyendo el DS 40, DS 44, DS 16 y otros cuerpos legales aplicables."}),(0,i.jsx)("li",{children:"Implementar y verificar la eficacia de las medidas de control definidas en la matriz IPER (Identificaci\xf3n de Peligros y Evaluaci\xf3n de Riesgos)."}),(0,i.jsx)("li",{children:"Integrar de manera transversal el enfoque de g\xe9nero en toda la gesti\xf3n preventiva, conforme a las modificaciones del DS 44, garantizando condiciones equitativas y seguras para todos los trabajadores y trabajadoras."}),(0,i.jsx)("li",{children:"Fomentar una cultura de seguridad participativa y de autocuidado en todos los niveles de la organizaci\xf3n."})]})]})})}function E(e){var a;let{obra:s}=e;return(0,i.jsx)(C,{title:"Organizaci\xf3n Interna de la Seguridad",description:"Estructura de roles, responsabilidades y l\xedneas de mando en materias de prevenci\xf3n de riesgos para la obra.",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Esta secci\xf3n describe c\xf3mo se organiza la seguridad en la obra, qui\xe9n toma decisiones, qui\xe9n supervisa y qui\xe9n ejecuta las acciones de prevenci\xf3n de riesgos."}),(0,i.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,i.jsxs)("div",{className:"border rounded-xl p-3 bg-white",children:[(0,i.jsx)("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1.5",children:"Mandante"}),(0,i.jsx)("p",{className:"text-sm font-medium text-gray-800",children:(null==s?void 0:s.mandanteRazonSocial)||"Mandante principal no especificado"})]}),(0,i.jsxs)("div",{className:"border rounded-xl p-3 bg-white",children:[(0,i.jsx)("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1.5",children:"Empresa Contratista"}),(0,i.jsx)("p",{className:"text-sm font-medium text-gray-800",children:(null==s?void 0:null===(a=s.empresa)||void 0===a?void 0:a.nombre)||"Constructora PCG (empresa principal)"})]}),(0,i.jsxs)("div",{className:"border rounded-xl p-3 bg-white",children:[(0,i.jsx)("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1.5",children:"Jefe de Obra / Administrador de Contrato"}),(0,i.jsx)("p",{className:"text-sm font-medium text-gray-800",children:(null==s?void 0:s.jefeObraNombre)||"No especificado"}),(0,i.jsx)("p",{className:"mt-1.5 text-xs text-gray-500",children:"M\xe1ximo responsable de la gesti\xf3n de la obra, incluyendo la asignaci\xf3n de recursos para la seguridad."})]}),(0,i.jsxs)("div",{className:"border rounded-xl p-3 bg-white",children:[(0,i.jsx)("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1.5",children:"Prevencionista Responsable"}),(0,i.jsx)("p",{className:"text-sm font-medium text-gray-800",children:(null==s?void 0:s.prevencionistaNombre)||"No especificado"}),(0,i.jsx)("p",{className:"mt-1.5 text-xs text-gray-500",children:"Encargado de coordinar la implementaci\xf3n del PPR, la IPER y la supervisi\xf3n de las medidas de control."})]})]}),(0,i.jsxs)("div",{className:"border rounded-xl p-3 bg-white",children:[(0,i.jsx)("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1.5",children:"L\xedneas de mando y reporte"}),(0,i.jsxs)("ul",{className:"list-disc list-inside text-sm text-gray-700 space-y-1",children:[(0,i.jsx)("li",{children:"Administraci\xf3n de obra responsable de la gesti\xf3n global."}),(0,i.jsx)("li",{children:"Prevencionista reporta directamente a la administraci\xf3n de obra y a la gerencia de prevenci\xf3n de la empresa."}),(0,i.jsx)("li",{children:"Jefes de \xe1rea y supervisores son responsables de implementar y hacer cumplir las medidas de control en sus equipos."}),(0,i.jsx)("li",{children:"Trabajadores y trabajadoras tienen el deber de cumplir las instrucciones de seguridad y reportar condiciones inseguras."})]})]})]})})}var I=s(33804);function O(e){let{iperData:a}=e;return(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)(I.iA,{children:[(0,i.jsx)(I.xD,{children:(0,i.jsxs)(I.SC,{children:[(0,i.jsx)(I.ss,{children:"Tarea"}),(0,i.jsx)(I.ss,{children:"Peligro"}),(0,i.jsx)(I.ss,{children:"Riesgo"}),(0,i.jsx)(I.ss,{children:"Riesgo Inherente (H/M)"}),(0,i.jsx)(I.ss,{children:"Riesgo Residual"})]})}),(0,i.jsx)(I.RM,{children:a.map(e=>(0,i.jsxs)(I.SC,{children:[(0,i.jsx)(I.pj,{className:"font-medium",children:e.tarea}),(0,i.jsx)(I.pj,{children:e.peligro}),(0,i.jsx)(I.pj,{children:e.riesgo}),(0,i.jsx)(I.pj,{children:(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("span",{className:"font-bold text-blue-600",children:e.nivel_riesgo_hombre}),(0,i.jsx)("span",{children:"/"}),(0,i.jsx)("span",{className:"font-bold text-pink-600",children:e.nivel_riesgo_mujer})]})}),(0,i.jsx)(I.pj,{className:"font-bold text-green-600",children:e.nivel_riesgo_residual})]},e.id))})]})})}function D(e){let{iperData:a}=e;return(0,i.jsx)(C,{title:"Identificaci\xf3n de Peligros y Evaluaci\xf3n de Riesgos (IPER)",description:"Matriz que detalla los peligros, riesgos y controles de cada actividad de la obra, incluyendo el enfoque de g\xe9nero.",children:0===a.length?(0,i.jsxs)("div",{className:"text-center bg-muted/50 p-8 rounded-lg",children:[(0,i.jsx)("p",{className:"text-muted-foreground mb-4",children:"No hay registros IPER para esta obra. La matriz IPER se gestiona desde el m\xf3dulo de Formularios Generales."}),(0,i.jsx)(n.z,{children:"Ir a gesti\xf3n de IPER"})]}):(0,i.jsx)(O,{iperData:a})})}function T(e){let{iperData:a}=e,s=a.flatMap(e=>{let a=e.medidasControlPropuestas?e.medidasControlPropuestas.split("\n"):[];return e.control_especifico_genero&&a.push("(Enfoque de G\xe9nero) ".concat(e.control_especifico_genero)),a.map(a=>({peligro:e.peligro,control:a,responsable:e.responsableImplementacion||e.responsable}))}).filter(e=>""!==e.control.trim());return(0,i.jsx)("div",{className:"space-y-4",children:s.map((e,a)=>(0,i.jsxs)("div",{className:"p-3 border rounded-md bg-muted/50",children:[(0,i.jsx)("p",{className:"font-semibold text-sm",children:e.control}),(0,i.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[(0,i.jsxs)("span",{children:["Peligro asociado: ",e.peligro]})," | ",(0,i.jsxs)("span",{children:["Responsable: ",e.responsable||"No asignado"]})]})]},a))})}function F(e){let{iperData:a}=e;return(0,i.jsx)(C,{title:"Medidas de Control por cada Peligro",description:"Descripci\xf3n de los controles a implementar, generados autom\xe1ticamente desde la matriz IPER.",children:0===a.length?(0,i.jsx)("p",{className:"text-muted-foreground",children:"No hay registros IPER para mostrar las medidas de control."}):(0,i.jsx)(T,{iperData:a})})}var w=s(69174);function z(e){let{charlasData:a}=e;return(0,i.jsx)(C,{title:"Charlas y Capacitaci\xf3n",description:"Calendario de capacitaciones y charlas de seguridad, generado autom\xe1ticamente a partir de la programaci\xf3n y la matriz IPER.",children:0===a.length?(0,i.jsx)("div",{className:"text-center bg-muted/50 p-8 rounded-lg",children:(0,i.jsx)("p",{className:"text-muted-foreground mb-4",children:"No hay charlas registradas para esta obra. Se pueden generar desde la secci\xf3n IPER."})}):(0,i.jsxs)(I.iA,{children:[(0,i.jsx)(I.xD,{children:(0,i.jsxs)(I.SC,{children:[(0,i.jsx)(I.ss,{children:"T\xedtulo"}),(0,i.jsx)(I.ss,{children:"Fecha Creaci\xf3n"}),(0,i.jsx)(I.ss,{children:"Estado"}),(0,i.jsx)(I.ss,{children:"Referencia IPER"})]})}),(0,i.jsx)(I.RM,{children:a.map(e=>{var a,s;return(0,i.jsxs)(I.SC,{children:[(0,i.jsx)(I.pj,{className:"font-medium",children:e.titulo}),(0,i.jsx)(I.pj,{children:null===(a=e.fechaCreacion)||void 0===a?void 0:a.toDate().toLocaleDateString("es-CL")}),(0,i.jsx)(I.pj,{children:(0,i.jsx)(w.C,{variant:"borrador"===e.estado?"secondary":"default",children:e.estado})}),(0,i.jsx)(I.pj,{className:"font-mono text-xs",children:(null===(s=e.iperId)||void 0===s?void 0:s.substring(0,8))||"N/A"})]},e.id)})})]})})}function _(e){let{iperData:a}=e,s=(0,o.useMemo)(()=>{let e=new Set;return e.add("Capacitaci\xf3n sobre el contenido de la matriz IPER con enfoque de g\xe9nero."),e.add("Instrucci\xf3n sobre el correcto uso y tallaje de Elementos de Protecci\xf3n Personal (EPP), destacando la disponibilidad de tallas para mujeres."),e.add("Capacitaci\xf3n sobre los protocolos de protecci\xf3n de trabajadoras embarazadas y en per\xedodo de lactancia."),a.forEach(a=>{"Ergon\xf3mico"!==a.categoriaPeligro||e.has("Capacitaci\xf3n en ergonom\xeda y manejo manual de cargas, con consideraciones diferenciadas.")||e.add("Capacitaci\xf3n en ergonom\xeda y manejo manual de cargas, con consideraciones diferenciadas."),a.control_especifico_genero&&e.add("Capacitaci\xf3n sobre control de g\xe9nero: ".concat(a.control_especifico_genero))}),Array.from(e)},[a]);return(0,i.jsx)(C,{title:"Plan de Capacitaci\xf3n Cumpliendo DS 44",description:"Detalle de las capacitaciones obligatorias que incorporan el enfoque de g\xe9nero, seg\xfan la normativa.",children:(0,i.jsx)("div",{className:"prose prose-sm max-w-none text-muted-foreground",children:(0,i.jsx)("ul",{children:s.map((e,a)=>(0,i.jsx)("li",{children:e},a))})})})}function M(){return(0,i.jsx)(C,{title:"Procedimientos de Trabajo Seguro (PTS)",description:"Listado de los PTS aplicables a la obra. Se pueden adjuntar documentos PDF o utilizar plantillas estandarizadas.",children:(0,i.jsxs)("div",{className:"text-center bg-muted/50 p-8 rounded-lg",children:[(0,i.jsx)("p",{className:"text-muted-foreground mb-4",children:"Esta secci\xf3n listar\xe1 los Procedimientos de Trabajo Seguro. Pr\xf3ximamente podr\xe1s adjuntar los PDF de cada procedimiento."}),(0,i.jsx)(n.z,{children:"Adjuntar Procedimiento"})]})})}function A(){return(0,i.jsx)(C,{title:"Protocolos de Emergencia",description:"Planes de acci\xf3n espec\xedficos para situaciones de emergencia, como incendios, sismos o accidentes graves.",children:(0,i.jsx)("div",{className:"prose prose-sm max-w-none text-muted-foreground",children:(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Plan de Evacuaci\xf3n:"})," Define las v\xedas de escape, zonas de seguridad y puntos de encuentro."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Protocolo de Incendios:"})," Instrucciones sobre el uso de extintores, ubicaci\xf3n de la red h\xfameda y contacto con bomberos."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Protocolo de Primeros Auxilios:"})," Pasos a seguir en caso de accidente, ubicaci\xf3n de botiquines y contacto de emergencia."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Protocolo de Rescate en Altura:"})," Procedimiento espec\xedfico para emergencias en trabajos de altura."]})]})})})}function G(e){let{iperData:a}=e,s=(0,o.useMemo)(()=>{let e=a.filter(e=>(e.nivel_riesgo_hombre||0)>=15||(e.nivel_riesgo_mujer||0)>=15);if(0===e.length)return{frecuencia:"Semanal",responsable:"Prevencionista en Terreno",checklists:"Checklist de Orden y Aseo, Checklist de EPP."};let s=new Set;return e.forEach(e=>{e.peligro.toLowerCase().includes("altura")&&s.add("Trabajo en Altura"),e.peligro.toLowerCase().includes("el\xe9ctrico")&&s.add("Riesgo El\xe9ctrico"),e.peligro.toLowerCase().includes("excavaci")&&s.add("Excavaciones")}),{frecuencia:"Diaria para riesgos cr\xedticos, Semanal para generales.",responsable:"Supervisor de \xe1rea y Prevencionista de Riesgos.",checklists:"Checklist Generales + Espec\xedficos para: ".concat(Array.from(s).join(", "),".")}},[a]);return(0,i.jsx)(C,{title:"Plan de Fiscalizaci\xf3n Interna",description:"Programa de inspecciones y observaciones planeadas para verificar el cumplimiento de las medidas de seguridad en terreno.",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)(y,{label:"Frecuencia de inspecciones",value:s.frecuencia}),(0,i.jsx)(y,{label:"Responsable de fiscalizaci\xf3n",value:s.responsable}),(0,i.jsx)(y,{label:"Checklists aplicables",value:s.checklists})]})})}function L(){return(0,i.jsx)(C,{title:"Registro y Seguimiento",description:"Documentaci\xf3n de la recepci\xf3n del programa por parte de los responsables y seguimiento de su implementaci\xf3n.",children:(0,i.jsxs)("div",{className:"text-center bg-muted/50 p-8 rounded-lg",children:[(0,i.jsx)("p",{className:"text-muted-foreground mb-4",children:"Esta secci\xf3n permitir\xe1 registrar las firmas de recepci\xf3n del PPR y mostrar\xe1 un historial de auditor\xedas y revisiones."}),(0,i.jsx)(n.z,{children:"Registrar Firma de Recepci\xf3n"})]})})}function k(){return(0,i.jsx)(C,{title:"Enfoque de G\xe9nero (Obligatorio DS 44)",description:"Secci\xf3n expl\xedcita que demuestra c\xf3mo el programa considera y aborda las diferencias de g\xe9nero en la gesti\xf3n de riesgos.",children:(0,i.jsxs)("div",{className:"prose prose-sm max-w-none text-muted-foreground",children:[(0,i.jsx)("p",{children:"Este programa integra activamente el enfoque de g\xe9nero en cumplimiento con el DS 44, a trav\xe9s de las siguientes acciones:"}),(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Evaluaci\xf3n de Riesgos Diferenciada:"})," La matriz IPER incluye una evaluaci\xf3n separada de probabilidad y consecuencia para hombres y mujeres, considerando factores ergon\xf3micos y de exposici\xf3n."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Medidas de Control Espec\xedficas:"})," Se han definido controles espec\xedficos, como la adecuaci\xf3n de l\xedmites de manejo manual de cargas y la provisi\xf3n de EPP en tallajes adecuados."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Protecci\xf3n a la Maternidad:"})," Se establecen protocolos claros para la protecci\xf3n de trabajadoras embarazadas y en per\xedodo de lactancia, reasignando tareas de riesgo cuando sea necesario."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Capacitaci\xf3n Inclusiva:"})," El plan de capacitaci\xf3n incluye m\xf3dulos espec\xedficos sobre ergonom\xeda y uso de EPP con perspectiva de g\xe9nero."]})]})]})})}var q=s(15291),Z=s(75060),J=s(5978),U=s(99764),V=s(69140),H=s(53459),Y=s(24180),B=s(53375),$=s(2578),Q=s.n($);let X={es:{title:"Programa de Prevenci\xf3n de Riesgos (PPR)",subtitle:"PCG \xb7 Plataforma de Control y Gesti\xf3n",index:"\xcdndice de Contenidos",footer:"PCG – Programa de Prevenci\xf3n de Riesgos",page:"P\xe1gina",fileName:"PPR",section1:"1. Informaci\xf3n General de la Obra",section2:"2. Objetivo del Programa",section3:"3. Organizaci\xf3n Interna",section4:"4. Identificaci\xf3n de Peligros y Evaluaci\xf3n de Riesgos (IPER)",section5:"5. Medidas de Control",section6:"6. Charlas y Capacitaci\xf3n",section7:"7. Plan de Capacitaci\xf3n DS 44",section8:"8. Procedimientos de Trabajo Seguro",section9:"9. Protocolos de Emergencia",section10:"10. Plan de Fiscalizaci\xf3n Interna",section11:"11. Registro y Seguimiento",section12:"12. Enfoque de G\xe9nero (DS 44)",fieldNombreObra:"Nombre de la obra",fieldUbicacion:"Ubicaci\xf3n",fieldMandante:"Empresa mandante",fieldContratista:"Empresa contratista",fieldFechaInicio:"Fecha de inicio",fieldFechaTermino:"Fecha de t\xe9rmino estimada",fieldPrevencionista:"Prevencionista responsable",fieldFechaGeneracion:"Fecha de Generaci\xf3n",textObjetivo:"Establecer las directrices y acciones necesarias para prevenir accidentes y enfermedades profesionales en la obra, cumpliendo la legislaci\xf3n vigente y protocolos internos del mandante y contratista.",textPlaceholder:"Esta secci\xf3n se completar\xe1 a medida que se registren actividades y documentos asociados en la plataforma PCG.",noIper:"No hay registros IPER para esta obra.",noMedidas:"No hay medidas de control definidas (sin IPER).",noCharlas:"No hay charlas registradas para esta obra.",tableOrgCargo:"Cargo",tableOrgNombre:"Nombre",tableOrgRol:"Rol en el Sistema de Gesti\xf3n",cargoJefeObra:"Jefe de Obra",cargoPrevencionista:"Prevencionista",rolJefeObra:"M\xe1ximo responsable de la gesti\xf3n y recursos.",rolPrevencionista:"Coordinador y asesor t\xe9cnico del PPR.",tableIperTarea:"Tarea",tableIperPeligro:"Peligro",tableIperRiesgo:"Riesgo",tableIperRiesgoHM:"Riesgo H/M",tableIperRiesgoResidual:"Riesgo Residual",tableControlPeligro:"Peligro",tableControlMedida:"Control Espec\xedfico (G\xe9nero)",tableControlResponsable:"Responsable",tableCharlasTitulo:"T\xedtulo",tableCharlasFecha:"Fecha Creaci\xf3n",tableCharlasEstado:"Estado",noRegistrado:"No registrado",noAsignado:"No asignado",noEspecificado:"No especificado",tableInfoCampo:"Campo",tableInfoValor:"Valor"},pt:{title:"Programa de Preven\xe7\xe3o de Riscos (PPR)",subtitle:"PCG \xb7 Plataforma de Controle e Gest\xe3o",index:"\xcdndice de Conte\xfados",footer:"PCG – Programa de Preven\xe7\xe3o de Riscos",page:"P\xe1gina",fileName:"PPR",section1:"1. Informa\xe7\xf5es Gerais da Obra",section2:"2. Objetivo do Programa",section3:"3. Organiza\xe7\xe3o Interna",section4:"4. Identifica\xe7\xe3o de Perigos e Avalia\xe7\xe3o de Riscos (IPER)",section5:"5. Medidas de Controle",section6:"6. Palestras e Capacita\xe7\xf5es",section7:"7. Plano de Capacita\xe7\xe3o (Conforme Norma)",section8:"8. Procedimentos de Trabalho Seguro",section9:"9. Protocolos de Emerg\xeancia",section10:"10. Plano de Fiscaliza\xe7\xe3o Interna",section11:"11. Registro e Acompanhamento",section12:"12. Enfoque de G\xeanero (Conforme Norma)",fieldNombreObra:"Nome da Obra",fieldUbicacion:"Localiza\xe7\xe3o",fieldMandante:"Empresa Contratante",fieldContratista:"Empresa Contratada",fieldFechaInicio:"Data de In\xedcio",fieldFechaTermino:"Data de T\xe9rmino Estimada",fieldPrevencionista:"Respons\xe1vel pela Preven\xe7\xe3o",fieldFechaGeneracion:"Data de Gera\xe7\xe3o",textObjetivo:"Estabelecer as diretrizes e a\xe7\xf5es necess\xe1rias para prevenir acidentes de trabalho e doen\xe7as ocupacionais na obra, cumprindo a legisla\xe7\xe3o vigente e os protocolos internos do contratante e do contratado.",textPlaceholder:"Esta se\xe7\xe3o ser\xe1 preenchida \xe0 medida que atividades e documentos associados forem registrados na plataforma PCG.",noIper:"N\xe3o h\xe1 registros IPER para esta obra.",noMedidas:"N\xe3o h\xe1 medidas de controle definidas (sem IPER).",noCharlas:"N\xe3o h\xe1 palestras registradas para esta obra.",tableOrgCargo:"Cargo",tableOrgNombre:"Nome",tableOrgRol:"Papel no Sistema de Gest\xe3o",cargoJefeObra:"Chefe de Obra",cargoPrevencionista:"T\xe9cnico de Seguran\xe7a",rolJefeObra:"Respons\xe1vel m\xe1ximo pela gest\xe3o e recursos.",rolPrevencionista:"Coordenador e consultor t\xe9cnico do PPR.",tableIperTarea:"Tarefa",tableIperPeligro:"Perigo",tableIperRiesgo:"Risco",tableIperRiesgoHM:"Risco H/M",tableIperRiesgoResidual:"Risco Residual",tableControlPeligro:"Perigo",tableControlMedida:"Controle Espec\xedfico (G\xeanero)",tableControlResponsable:"Respons\xe1vel",tableCharlasTitulo:"T\xedtulo",tableCharlasFecha:"Data de Cria\xe7\xe3o",tableCharlasEstado:"Estado",noRegistrado:"N\xe3o registrado",noAsignado:"N\xe3o atribu\xeddo",noEspecificado:"N\xe3o especificado",tableInfoCampo:"Campo",tableInfoValor:"Valor"}},K=[226,232,240];function W(e,a,s){let i=X[s];e.setFont("helvetica","bold"),e.setFontSize(16),e.text(i.subtitle,15,20),e.setFont("helvetica","normal"),e.setFontSize(10),e.text("".concat(i.title,": ").concat(a),15,26)}function ee(e,a,s){return s>250&&(e.addPage(),s=40),e.setFont("helvetica","bold"),e.setFontSize(14),e.text(a,15,s),e.line(15,s+1.5,195,s+1.5),s+10}async function ea(e){var a,s;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"es",o=X[i],{obra:r,iperRegistros:n,charlas:t}=e,l=new B.default("p","mm","a4");l.setFont("helvetica","bold"),l.setFontSize(22),l.text(o.title,105,80,{align:"center"}),l.setFontSize(12),l.text(o.subtitle,105,88,{align:"center"}),l.setFontSize(18),l.text(r.nombreFaena,105,110,{align:"center"}),l.setFont("helvetica","normal"),l.setFontSize(12),l.text("".concat(o.fieldContratista,": ").concat((null===(a=r.empresa)||void 0===a?void 0:a.nombre)||"Constructora PCG Ltda."),105,130,{align:"center"}),l.text("".concat(o.fieldMandante,": ").concat(r.mandanteRazonSocial||o.noEspecificado),105,138,{align:"center"}),l.text("".concat(o.fieldPrevencionista,": ").concat(r.prevencionistaNombre||o.noEspecificado),105,146,{align:"center"}),l.text("".concat(o.fieldFechaGeneracion,": ").concat(new Date().toLocaleDateString("pt"===i?"pt-BR":"es-CL")),105,160,{align:"center"}),l.addPage(),W(l,r.nombreFaena,i);let c=40;c=ee(l,o.index,c);let d=[o.section1,o.section2,o.section3,o.section4,o.section5,o.section6,o.section7,o.section8,o.section9,o.section10,o.section11,o.section12];Q()(l,{startY:c,body:d.map(e=>[e]),theme:"plain",styles:{fontSize:11,cellPadding:2}}),l.addPage(),W(l,r.nombreFaena,i),c=40,c=ee(l,o.section1,c),Q()(l,{startY:c,head:[[o.tableInfoCampo,o.tableInfoValor]],body:[[o.fieldNombreObra,r.nombreFaena],[o.fieldUbicacion,r.direccion||o.noRegistrado],[o.fieldMandante,r.mandanteRazonSocial||o.noRegistrado],[o.fieldContratista,(null===(s=r.empresa)||void 0===s?void 0:s.nombre)||o.noRegistrado],[o.fieldFechaInicio,r.fechaInicio?new Date(r.fechaInicio+"T00:00:00").toLocaleDateString("pt"===i?"pt-BR":"es-CL"):o.noRegistrado],[o.fieldFechaTermino,r.fechaTermino?new Date(r.fechaTermino+"T00:00:00").toLocaleDateString("pt"===i?"pt-BR":"es-CL"):o.noRegistrado],[o.fieldPrevencionista,r.prevencionistaNombre||o.noRegistrado]],theme:"grid",headStyles:{fillColor:K,textColor:20},columnStyles:{0:{fontStyle:"bold"}}}),l.addPage(),W(l,r.nombreFaena,i),c=40,c=ee(l,o.section2,c),c=function(e,a,s){e.setFont("helvetica","normal"),e.setFontSize(10);let i=e.splitTextToSize(a,180);return e.text(i,15,s),s+5*i.length+5}(l,o.textObjetivo,c),l.addPage(),W(l,r.nombreFaena,i),c=40,c=ee(l,o.section3,c),Q()(l,{startY:c,head:[[o.tableOrgCargo,o.tableOrgNombre,o.tableOrgRol]],body:[[o.cargoJefeObra,r.jefeObraNombre||o.noAsignado,o.rolJefeObra],[o.cargoPrevencionista,r.prevencionistaNombre||o.noAsignado,o.rolPrevencionista]],theme:"grid",headStyles:{fillColor:K,textColor:20}}),l.addPage(),W(l,r.nombreFaena,i),c=40,c=ee(l,o.section4,c),n.length>0?Q()(l,{startY:c,head:[[o.tableIperTarea,o.tableIperPeligro,o.tableIperRiesgo,o.tableIperRiesgoHM,o.tableIperRiesgoResidual]],body:n.map(e=>[e.tarea,e.peligro,e.riesgo,"".concat(e.nivel_riesgo_hombre,"/").concat(e.nivel_riesgo_mujer),e.nivel_riesgo_residual]),theme:"grid",headStyles:{fillColor:K,textColor:20}}):l.text(o.noIper,15,c),l.addPage(),W(l,r.nombreFaena,i),c=40,c=ee(l,o.section5,c),n.length>0?Q()(l,{startY:c,head:[[o.tableControlPeligro,o.tableControlMedida,o.tableControlResponsable]],body:n.map(e=>[e.peligro,e.control_especifico_genero||"-",e.responsable||"-"]),theme:"grid",headStyles:{fillColor:K,textColor:20}}):l.text(o.noMedidas,15,c),l.addPage(),W(l,r.nombreFaena,i),c=40,c=ee(l,o.section6,c),t.length>0?Q()(l,{startY:c,head:[[o.tableCharlasTitulo,o.tableCharlasFecha,o.tableCharlasEstado]],body:t.map(e=>[e.titulo,e.fechaCreacion.toDate().toLocaleDateString("pt"===i?"pt-BR":"es-CL"),e.estado]),theme:"grid",headStyles:{fillColor:K,textColor:20}}):l.text(o.noCharlas,15,c),[o.section7,o.section8,o.section9,o.section10,o.section11,o.section12].forEach(e=>{l.addPage(),W(l,r.nombreFaena,i),c=ee(l,e,c=40),l.text(o.textPlaceholder,15,c)}),function(e,a,s){let i=X[s],o=e.internal.getNumberOfPages();for(let s=1;s<=o;s++){e.setPage(s);let r=e.internal.pageSize.getHeight();e.setFontSize(8),e.setTextColor(120),e.text(a,15,r-10),e.text(i.footer,105,r-10,{align:"center"}),e.text("".concat(i.page," ").concat(s," / ").concat(o),195,r-10,{align:"right"}),e.setTextColor(0)}}(l,r.nombreFaena,i);let m=new Date().toISOString().slice(0,10).replace(/-/g,""),p=i.toUpperCase(),u="".concat(o.fileName,"_").concat(r.nombreFaena.replace(/ /g,"_"),"_").concat(m,"_").concat(p,".pdf");l.save(u)}var es=s(23340),ei=s(5255),eo=s(81475),er=s(12032);let en={verde:{color:"bg-green-100 border-green-300 text-green-800",icon:ei.Z,title:"PPR al D\xeda"},amarillo:{color:"bg-yellow-100 border-yellow-300 text-yellow-800",icon:eo.Z,title:"PPR con Observaciones"},rojo:{color:"bg-red-100 border-red-300 text-red-800",icon:er.Z,title:"PPR Desactualizado o Incompleto"}};function et(e){let{status:a}=e,s=en[a.nivel],o=s.icon;return(0,i.jsxs)(N.Zb,{className:(0,r.cn)("border-l-4",s.color),children:[(0,i.jsx)(N.Ol,{children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)(o,{className:"h-6 w-6"}),(0,i.jsx)(N.ll,{className:"text-lg",children:a.titulo})]})}),(0,i.jsx)(N.aY,{children:(0,i.jsx)("ul",{className:"space-y-1 text-sm list-disc pl-5",children:a.mensajes.map((e,a)=>(0,i.jsx)("li",{children:e},a))})})]})}var el=s(31303),ec=s(71245);function ed(){let[e,a]=(0,o.useState)("info-general"),[s,r]=(0,o.useState)([]),[t,l]=(0,o.useState)(""),[c,d]=(0,o.useState)(null),[m,p]=(0,o.useState)([]),[u,g]=(0,o.useState)([]),[h,x]=(0,o.useState)(!1),[b,f]=(0,o.useState)(!1),[j,v]=(0,o.useState)(null),{toast:N}=(0,es.pm)(),{companyId:C,role:y}=(0,ec.a)();(0,o.useEffect)(()=>{(C||"superadmin"===y)&&(async()=>{let e;e="superadmin"===y?(0,J.IO)((0,J.hJ)(U.N$,"obras")):(0,J.IO)((0,J.hJ)(U.N$,"obras"),(0,J.ar)("empresaId","==",C));let a=(await (0,J.PL)(e)).docs.map(e=>({id:e.id,...e.data()}));r(a),a.length>0&&l(a[0].id)})()},[C,y]),(0,o.useEffect)(()=>{t&&(async()=>{x(!0);let e=(0,J.JU)(U.N$,"obras",t),a=await (0,J.QT)(e);a.exists()&&d({id:a.id,...a.data()});let s=(0,J.IO)((0,J.hJ)(U.N$,"obras",t,"iper")),i=(await (0,J.PL)(s)).docs.map(e=>({id:e.id,...e.data()}));p(i);let o=(0,J.IO)((0,J.hJ)(U.N$,"charlas"),(0,J.ar)("obraId","==",t)),r=(await (0,J.PL)(o)).docs.map(e=>({id:e.id,...e.data()}));g(r),v(function(e){let{iperRegistros:a,charlas:s}=e,i=[];if(0===a.length)return i.push("No existen registros IPER para esta obra. Es fundamental identificar peligros y evaluar riesgos para iniciar la gesti\xf3n preventiva."),{nivel:"rojo",titulo:"PPR Cr\xedtico: Sin Matriz de Riesgos",mensajes:i};let o=a.filter(e=>(e.nivel_riesgo_hombre||0)>=15||(e.nivel_riesgo_mujer||0)>=15),r=new Set(s.map(e=>e.iperId)),n=o.filter(e=>!r.has(e.id));n.length>0&&(i.push("Hay ".concat(n.length," riesgo(s) de nivel alto/cr\xedtico que no tienen una charla de seguridad asociada.")),n.slice(0,2).forEach(e=>{i.push('- Riesgo Cr\xedtico: "'.concat(e.peligro,'" en la tarea "').concat(e.tarea,'".'))}));let t=s.filter(e=>"realizada"===e.estado);if(s.length>0&&0===t.length&&i.push("Existen charlas creadas, pero ninguna ha sido marcada como 'realizada'. Es importante registrar la ejecuci\xf3n de las capacitaciones."),i.length>0)return{nivel:"rojo",titulo:"PPR Cr\xedtico: Riesgos Altos sin Control Comunicado",mensajes:i};let l=new Date,c=s.filter(e=>"borrador"===e.estado&&e.fechaCreacion&&(0,el.j)(l,e.fechaCreacion.toDate())>7);return(c.length>0&&i.push("Existen ".concat(c.length," charlas en borrador con m\xe1s de 7 d\xedas de antig\xfcedad sin ser marcadas como realizadas.")),i.length>0)?{nivel:"amarillo",titulo:"PPR con Observaciones",mensajes:i}:(i.push("El Programa de Prevenci\xf3n de Riesgos se encuentra al d\xeda seg\xfan la informaci\xf3n registrada en IPER y charlas de seguridad."),i.push("Todos los riesgos cr\xedticos identificados tienen al menos una charla de seguridad asociada."),{nivel:"verde",titulo:"PPR al D\xeda",mensajes:i})}({iperRegistros:i,charlas:r})),x(!1)})()},[t]);let I=async e=>{if(!c){N({variant:"destructive",title:"Error",description:"No hay una obra seleccionada para exportar."});return}f(!0);try{await ea({obra:c,iperRegistros:m,charlas:u},e)}catch(e){console.error("Error generando PDF:",e),N({variant:"destructive",title:"Error al generar PDF",description:"Ocurri\xf3 un problema al crear el documento."})}finally{f(!1)}};return(0,i.jsxs)("div",{className:"grid md:grid-cols-[280px_1fr] gap-8 items-start",children:[(0,i.jsx)(P,{activeSection:e,setActiveSection:a}),(0,i.jsxs)("main",{className:"space-y-8",children:[(0,i.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-4",children:[(0,i.jsxs)("div",{className:"max-w-md space-y-2",children:[(0,i.jsx)(Z._,{htmlFor:"obra-select",children:"Obra Seleccionada"}),(0,i.jsxs)(q.Ph,{value:t,onValueChange:l,children:[(0,i.jsx)(q.i4,{id:"obra-select",children:(0,i.jsx)(q.ki,{placeholder:"Seleccione una obra para ver su PPR"})}),(0,i.jsx)(q.Bw,{children:s.map(e=>(0,i.jsx)(q.Ql,{value:e.id,children:e.nombreFaena},e.id))})]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)(n.z,{onClick:()=>I("es"),disabled:b||!c,children:[b?(0,i.jsx)(H.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,i.jsx)(Y.Z,{className:"mr-2 h-4 w-4"}),"Descargar PPR (ES)"]}),(0,i.jsxs)(n.z,{onClick:()=>I("pt"),disabled:b||!c,variant:"secondary",children:[b?(0,i.jsx)(H.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,i.jsx)(Y.Z,{className:"mr-2 h-4 w-4"}),"Baixar PPR (PT)"]})]})]}),h?(0,i.jsx)(V.O,{className:"h-24 w-full"}):j?(0,i.jsx)(et,{status:j}):null,(()=>{if(h)return(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)(V.O,{className:"h-12 w-1/2"}),(0,i.jsx)(V.O,{className:"h-8 w-3/4"}),(0,i.jsxs)("div",{className:"space-y-2 pt-4",children:[(0,i.jsx)(V.O,{className:"h-6 w-full"}),(0,i.jsx)(V.O,{className:"h-6 w-full"}),(0,i.jsx)(V.O,{className:"h-6 w-5/6"})]})]});switch(e){case"info-general":default:return(0,i.jsx)(R,{obra:c});case"objetivo":return(0,i.jsx)(S,{});case"organizacion":return(0,i.jsx)(E,{obra:c});case"iper":return(0,i.jsx)(D,{iperData:m});case"medidas-control":return(0,i.jsx)(F,{iperData:m});case"charlas":return(0,i.jsx)(z,{charlasData:u});case"capacitacion-ds44":return(0,i.jsx)(_,{iperData:m});case"procedimientos":return(0,i.jsx)(M,{});case"protocolos-emergencia":return(0,i.jsx)(A,{});case"fiscalizacion":return(0,i.jsx)(G,{iperData:m});case"registro":return(0,i.jsx)(L,{});case"enfoque-genero":return(0,i.jsx)(k,{})}})()]})]})}},69140:function(e,a,s){"use strict";s.d(a,{O:function(){return r}});var i=s(57437),o=s(93448);function r(e){let{className:a,...s}=e;return(0,i.jsx)("div",{className:(0,o.cn)("animate-pulse rounded-md bg-muted",a),...s})}},23340:function(e,a,s){"use strict";s.d(a,{pm:function(){return p}});var i=s(2265);let o=0,r=new Map,n=e=>{if(r.has(e))return;let a=setTimeout(()=>{r.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,a)},t=(e,a)=>{switch(a.type){case"ADD_TOAST":return{...e,toasts:[a.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===a.toast.id?{...e,...a.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=a;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===a.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==a.toastId)}}},l=[],c={toasts:[]};function d(e){c=t(c,e),l.forEach(e=>{e(c)})}function m(e){let{...a}=e,s=(o=(o+1)%Number.MAX_SAFE_INTEGER).toString(),i=()=>d({type:"DISMISS_TOAST",toastId:s});return d({type:"ADD_TOAST",toast:{...a,id:s,open:!0,onOpenChange:e=>{e||i()}}}),{id:s,dismiss:i,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function p(){let[e,a]=i.useState(c);return i.useEffect(()=>(l.push(a),()=>{let e=l.indexOf(a);e>-1&&l.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}}},function(e){e.O(0,[4358,9990,2505,6137,1211,9759,3562,6008,9923,2550,6313,2578,8756,5284,2971,2117,1744],function(){return e(e.s=11979)}),_N_E=e.O()}]);